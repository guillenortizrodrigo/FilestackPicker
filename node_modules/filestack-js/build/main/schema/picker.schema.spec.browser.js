"use strict";
/*
 * Copyright (c) 2018 by Filestack.
 * Some rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
var assert = require("assert");
var _1 = require("./");
var jsdom = require("jsdom");
var JSDOM = jsdom.JSDOM;
describe('Picker Params Schema', function () {
    var validator = _1.getValidator(_1.PickerParamsSchema);
    var validate = function (params) {
        var res = validator(params);
        // if (res.errors.length) {
        //   console.log(res.errors);
        // }
        return res.errors.length === 0 ? true : false;
    };
    var assertFail = function (res) { return assert.ok(!res); };
    it('should validate allow manual retry', function () {
        assert.ok(validate({ allowManualRetry: true }));
        assertFail(validate({ allowManualRetry: {} }));
    });
    it('should validate accept param', function () {
        assert.ok(validate({ accept: 'image/jpeg' }));
        assert.ok(validate({ accept: ['image/jpeg', 'image/png', '*'] }));
        assertFail(validate({ accept: {} }));
    });
    it('should validate fromSources param', function () {
        assert.ok(validate({ fromSources: ['url', 'facebook'] }));
        assertFail(validate({ fromSources: ['wrong_source'] }));
    });
    it('should validate fromSources param type object', function () {
        assert.ok(validate({ fromSources: ['url', { test: 123 }, { test: function () { return console.log; } }] }));
    });
    it('should validate container param', function () {
        assert.ok(validate({ container: 'test' }));
        var nodeDiv = JSDOM.fragment("<div>Hello</div>").querySelector('div');
        var nodeP = JSDOM.fragment("<p>Hello</p>").querySelector('p');
        assert.ok(validate({ container: nodeDiv }));
        assert.ok(validate({ container: nodeP }));
        assertFail(validate({ container: {} }));
    });
    it('should validate cleanupImageExif param', function () {
        assert.ok(validate({ cleanupImageExif: true }));
        assert.ok(validate({
            cleanupImageExif: {
                keepOrientation: true,
            },
        }));
        assertFail(validate({
            cleanupImageExif: {
                test: 1,
            },
        }));
    });
    it('should validate displayMode param', function () {
        assert.ok(validate({ displayMode: 'inline' }));
        assert.ok(validate({ displayMode: 'overlay' }));
        assert.ok(validate({ displayMode: 'dropPane' }));
        assertFail(validate({ displayMode: 'test' }));
    });
    it('should validate imageDim param', function () {
        assert.ok(validate({ imageDim: [100, 100] }));
        assertFail(validate({ imageDim: [0, 1] }));
        assertFail(validate({ imageDim: [100, 100, 3] }));
    });
    it('should validate storeTo Params', function () {
        assert.ok(validate({
            storeTo: {
                filename: 'test',
                location: 's3',
                path: '/test/',
                region: 'test',
                access: 'public',
                workflows: ['test'],
            },
        }));
        assert.ok(validate({
            storeTo: {
                filename: 'test',
                location: 's3',
                path: '/test/',
                region: 'test',
                access: 'private',
                workflows: [
                    {
                        id: 'test',
                    },
                ],
            },
        }));
        assertFail(validate({
            storeTo: {
                workflows: {},
                access: 'none',
            },
        }));
    });
    it('should validate transformations param', function () {
        assert.ok(validate({
            transformations: {
                circle: true,
                rotate: true,
                crop: true,
            },
        }));
        assert.ok(validate({
            transformations: {
                circle: false,
                rotate: false,
                crop: {
                    force: true,
                    aspectRatio: 1 / 2,
                },
            },
        }));
        assertFail(validate({
            transformations: {
                test: 123,
            },
        }));
    });
    it('should validate customText param', function () {
        assert.ok(validate({
            customText: {
                sometest: 'testtext',
            },
        }));
        assertFail(validate({ customText: ['test', 'ts1'] }));
    });
    it('should validate customAuthText param', function () {
        assert.ok(validate({
            customAuthText: {
                test: {
                    top: 'test',
                    bottom: 'test2',
                },
            },
        }));
        assertFail(validate({
            customAuthText: {
                test: {
                    top: 'test',
                },
            },
        }));
        assertFail(validate({
            customAuthText: {
                test: '123',
            },
        }));
    });
    it('should validate ', function () {
        assert.ok(validate({
            uploadConfig: {
                partSize: 5 * 1024 * 1024,
                intelligent: true,
                onProgress: function () { return console; },
            },
        }));
        assert.ok(validate({
            uploadConfig: {
                intelligent: 'fallback',
            },
        }));
        assertFail(validate({
            uploadConfig: {
                partSize: 100,
            },
        }));
        assertFail(validate({
            uploadConfig: {
                progressInterval: 0,
            },
        }));
        assertFail(validate({
            uploadConfig: {
                concurrency: 0,
            },
        }));
    });
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zY2hlbWEvcGlja2VyLnNjaGVtYS5zcGVjLmJyb3dzZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7Ozs7R0FlRzs7QUFFSCwrQkFBaUM7QUFDakMsdUJBQXNEO0FBRXRELDZCQUErQjtBQUN2QixJQUFBLG1CQUFLLENBQVc7QUFFeEIsUUFBUSxDQUFDLHNCQUFzQixFQUFFO0lBQy9CLElBQU0sU0FBUyxHQUFHLGVBQVksQ0FBQyxxQkFBa0IsQ0FBQyxDQUFDO0lBRW5ELElBQU0sUUFBUSxHQUFHLFVBQUEsTUFBTTtRQUNyQixJQUFNLEdBQUcsR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFOUIsMkJBQTJCO1FBQzNCLDZCQUE2QjtRQUM3QixJQUFJO1FBRUosT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO0lBQ2hELENBQUMsQ0FBQztJQUVGLElBQU0sVUFBVSxHQUFHLFVBQUEsR0FBRyxJQUFJLE9BQUEsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFmLENBQWUsQ0FBQztJQUUxQyxFQUFFLENBQUMsb0NBQW9DLEVBQUU7UUFDdkMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsRUFBRSxnQkFBZ0IsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDaEQsVUFBVSxDQUFDLFFBQVEsQ0FBQyxFQUFFLGdCQUFnQixFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUNqRCxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyw4QkFBOEIsRUFBRTtRQUNqQyxNQUFNLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDOUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxRQUFRLENB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RTtnQkFDZCxJQUFJLEVBQUU7b0JBQ0osR0FBRyxFQUFFLE1BQU07aUJBQ1o7YUFDRjtTQUNGLENBQUMsQ0FDSCxDQUFDO1FBRUYsVUFBVSxDQUNSLFFBQVEsQ0FBQztZQUNQLGNBQWMsRUFBRTtnQkFDZCxJQUFJLEVBQUUsS0FBSzthQUNaO1NBQ0YsQ0FBQyxDQUNILENBQUM7SUFDSixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxrQkFBa0IsRUFBRTtRQUNyQixNQUFNLENBQUMsRUFBRSxDQUNQLFFBQVEsQ0FBQztZQUNQLFlBQVksRUFBRTtnQkFDWixRQUFRLEVBQUUsQ0FBQyxHQUFHLElBQUksR0FBRyxJQUFJO2dCQUN6QixXQUFXLEVBQUUsSUFBSTtnQkFDakIsVUFBVSxFQUFFLGNBQU0sT0FBQSxPQUFPLEVBQVAsQ0FBTzthQUMxQjtTQUNGLENBQUMsQ0FDSCxDQUFDO1FBRUYsTUFBTSxDQUFDLEVBQUUsQ0FDUCxRQUFRLENBQUM7WUFDUCxZQUFZLEVBQUU7Z0JBQ1osV0FBVyxFQUFFLFVBQVU7YUFDeEI7U0FDRixDQUFDLENBQ0gsQ0FBQztRQUVGLFVBQVUsQ0FDUixRQUFRLENBQUM7WUFDUCxZQUFZLEVBQUU7Z0JBQ1osUUFBUSxFQUFFLEdBQUc7YUFDZDtTQUNGLENBQUMsQ0FDSCxDQUFDO1FBRUYsVUFBVSxDQUNSLFFBQVEsQ0FBQztZQUNQLFlBQVksRUFBRTtnQkFDWixnQkFBZ0IsRUFBRSxDQUFDO2FBQ3BCO1NBQ0YsQ0FBQyxDQUNILENBQUM7UUFFRixVQUFVLENBQ1IsUUFBUSxDQUFDO1lBQ1AsWUFBWSxFQUFFO2dCQUNaLFdBQVcsRUFBRSxDQUFDO2FBQ2Y7U0FDRixDQUFDLENBQ0gsQ0FBQztJQUNKLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoic2NoZW1hL3BpY2tlci5zY2hlbWEuc3BlYy5icm93c2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCAoYykgMjAxOCBieSBGaWxlc3RhY2suXG4gKiBTb21lIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0ICogYXMgYXNzZXJ0IGZyb20gJ2Fzc2VydCc7XG5pbXBvcnQgeyBnZXRWYWxpZGF0b3IsIFBpY2tlclBhcmFtc1NjaGVtYSB9IGZyb20gJy4vJztcblxuaW1wb3J0ICogYXMganNkb20gZnJvbSAnanNkb20nO1xuY29uc3QgeyBKU0RPTSB9ID0ganNkb207XG5cbmRlc2NyaWJlKCdQaWNrZXIgUGFyYW1zIFNjaGVtYScsICgpID0+IHtcbiAgY29uc3QgdmFsaWRhdG9yID0gZ2V0VmFsaWRhdG9yKFBpY2tlclBhcmFtc1NjaGVtYSk7XG5cbiAgY29uc3QgdmFsaWRhdGUgPSBwYXJhbXMgPT4ge1xuICAgIGNvbnN0IHJlcyA9IHZhbGlkYXRvcihwYXJhbXMpO1xuXG4gICAgLy8gaWYgKHJlcy5lcnJvcnMubGVuZ3RoKSB7XG4gICAgLy8gICBjb25zb2xlLmxvZyhyZXMuZXJyb3JzKTtcbiAgICAvLyB9XG5cbiAgICByZXR1cm4gcmVzLmVycm9ycy5sZW5ndGggPT09IDAgPyB0cnVlIDogZmFsc2U7XG4gIH07XG5cbiAgY29uc3QgYXNzZXJ0RmFpbCA9IHJlcyA9PiBhc3NlcnQub2soIXJlcyk7XG5cbiAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBhbGxvdyBtYW51YWwgcmV0cnknLCAoKSA9PiB7XG4gICAgYXNzZXJ0Lm9rKHZhbGlkYXRlKHsgYWxsb3dNYW51YWxSZXRyeTogdHJ1ZSB9KSk7XG4gICAgYXNzZXJ0RmFpbCh2YWxpZGF0ZSh7IGFsbG93TWFudWFsUmV0cnk6IHt9IH0pKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBhY2NlcHQgcGFyYW0nLCAoKSA9PiB7XG4gICAgYXNzZXJ0Lm9rKHZhbGlkYXRlKHsgYWNjZXB0OiAnaW1hZ2UvanBlZycgfSkpO1xuICAgIGFzc2VydC5vayh2YWxpZGF0ZSh7IGFjY2VwdDogWydpbWFnZS9qcGVnJywgJ2ltYWdlL3BuZycsICcqJ10gfSkpO1xuICAgIGFzc2VydEZhaWwodmFsaWRhdGUoeyBhY2NlcHQ6IHt9IH0pKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBmcm9tU291cmNlcyBwYXJhbScsICgpID0+IHtcbiAgICBhc3NlcnQub2sodmFsaWRhdGUoeyBmcm9tU291cmNlczogWyd1cmwnLCAnZmFjZWJvb2snXSB9KSk7XG4gICAgYXNzZXJ0RmFpbCh2YWxpZGF0ZSh7IGZyb21Tb3VyY2VzOiBbJ3dyb25nX3NvdXJjZSddIH0pKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBmcm9tU291cmNlcyBwYXJhbSB0eXBlIG9iamVjdCcsICgpID0+IHtcbiAgICBhc3NlcnQub2sodmFsaWRhdGUoeyBmcm9tU291cmNlczogWyd1cmwnLCB7IHRlc3Q6IDEyMyB9LCB7IHRlc3Q6ICgpID0+IGNvbnNvbGUubG9nIH1dIH0pKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBjb250YWluZXIgcGFyYW0nLCAoKSA9PiB7XG4gICAgYXNzZXJ0Lm9rKHZhbGlkYXRlKHsgY29udGFpbmVyOiAndGVzdCcgfSkpO1xuXG4gICAgY29uc3Qgbm9kZURpdiA9IEpTRE9NLmZyYWdtZW50KGA8ZGl2PkhlbGxvPC9kaXY+YCkucXVlcnlTZWxlY3RvcignZGl2Jyk7XG4gICAgY29uc3Qgbm9kZVAgPSBKU0RPTS5mcmFnbWVudChgPHA+SGVsbG88L3A+YCkucXVlcnlTZWxlY3RvcigncCcpO1xuICAgIGFzc2VydC5vayh2YWxpZGF0ZSh7IGNvbnRhaW5lcjogbm9kZURpdiB9KSk7XG4gICAgYXNzZXJ0Lm9rKHZhbGlkYXRlKHsgY29udGFpbmVyOiBub2RlUCB9KSk7XG4gICAgYXNzZXJ0RmFpbCh2YWxpZGF0ZSh7IGNvbnRhaW5lcjoge30gfSkpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHZhbGlkYXRlIGNsZWFudXBJbWFnZUV4aWYgcGFyYW0nLCAoKSA9PiB7XG4gICAgYXNzZXJ0Lm9rKHZhbGlkYXRlKHsgY2xlYW51cEltYWdlRXhpZjogdHJ1ZSB9KSk7XG4gICAgYXNzZXJ0Lm9rKFxuICAgICAgdmFsaWRhdGUoe1xuICAgICAgICBjbGVhbnVwSW1hZ2VFeGlmOiB7XG4gICAgICAgICAga2VlcE9yaWVudGF0aW9uOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSlcbiAgICApO1xuICAgIGFzc2VydEZhaWwoXG4gICAgICB2YWxpZGF0ZSh7XG4gICAgICAgIGNsZWFudXBJbWFnZUV4aWY6IHtcbiAgICAgICAgICB0ZXN0OiAxLFxuICAgICAgICB9LFxuICAgICAgfSlcbiAgICApO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHZhbGlkYXRlIGRpc3BsYXlNb2RlIHBhcmFtJywgKCkgPT4ge1xuICAgIGFzc2VydC5vayh2YWxpZGF0ZSh7IGRpc3BsYXlNb2RlOiAnaW5saW5lJyB9KSk7XG4gICAgYXNzZXJ0Lm9rKHZhbGlkYXRlKHsgZGlzcGxheU1vZGU6ICdvdmVybGF5JyB9KSk7XG4gICAgYXNzZXJ0Lm9rKHZhbGlkYXRlKHsgZGlzcGxheU1vZGU6ICdkcm9wUGFuZScgfSkpO1xuICAgIGFzc2VydEZhaWwodmFsaWRhdGUoeyBkaXNwbGF5TW9kZTogJ3Rlc3QnIH0pKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBpbWFnZURpbSBwYXJhbScsICgpID0+IHtcbiAgICBhc3NlcnQub2sodmFsaWRhdGUoeyBpbWFnZURpbTogWzEwMCwgMTAwXSB9KSk7XG4gICAgYXNzZXJ0RmFpbCh2YWxpZGF0ZSh7IGltYWdlRGltOiBbMCwgMV0gfSkpO1xuICAgIGFzc2VydEZhaWwodmFsaWRhdGUoeyBpbWFnZURpbTogWzEwMCwgMTAwLCAzXSB9KSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgdmFsaWRhdGUgc3RvcmVUbyBQYXJhbXMnLCAoKSA9PiB7XG4gICAgYXNzZXJ0Lm9rKFxuICAgICAgdmFsaWRhdGUoe1xuICAgICAgICBzdG9yZVRvOiB7XG4gICAgICAgICAgZmlsZW5hbWU6ICd0ZXN0JyxcbiAgICAgICAgICBsb2NhdGlvbjogJ3MzJyxcbiAgICAgICAgICBwYXRoOiAnL3Rlc3QvJyxcbiAgICAgICAgICByZWdpb246ICd0ZXN0JyxcbiAgICAgICAgICBhY2Nlc3M6ICdwdWJsaWMnLFxuICAgICAgICAgIHdvcmtmbG93czogWyd0ZXN0J10sXG4gICAgICAgIH0sXG4gICAgICB9KVxuICAgICk7XG5cbiAgICBhc3NlcnQub2soXG4gICAgICB2YWxpZGF0ZSh7XG4gICAgICAgIHN0b3JlVG86IHtcbiAgICAgICAgICBmaWxlbmFtZTogJ3Rlc3QnLFxuICAgICAgICAgIGxvY2F0aW9uOiAnczMnLFxuICAgICAgICAgIHBhdGg6ICcvdGVzdC8nLFxuICAgICAgICAgIHJlZ2lvbjogJ3Rlc3QnLFxuICAgICAgICAgIGFjY2VzczogJ3ByaXZhdGUnLFxuICAgICAgICAgIHdvcmtmbG93czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBpZDogJ3Rlc3QnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgfSlcbiAgICApO1xuXG4gICAgYXNzZXJ0RmFpbChcbiAgICAgIHZhbGlkYXRlKHtcbiAgICAgICAgc3RvcmVUbzoge1xuICAgICAgICAgIHdvcmtmbG93czoge30sXG4gICAgICAgICAgYWNjZXNzOiAnbm9uZScsXG4gICAgICAgIH0sXG4gICAgICB9KVxuICAgICk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgdmFsaWRhdGUgdHJhbnNmb3JtYXRpb25zIHBhcmFtJywgKCkgPT4ge1xuICAgIGFzc2VydC5vayhcbiAgICAgIHZhbGlkYXRlKHtcbiAgICAgICAgdHJhbnNmb3JtYXRpb25zOiB7XG4gICAgICAgICAgY2lyY2xlOiB0cnVlLFxuICAgICAgICAgIHJvdGF0ZTogdHJ1ZSxcbiAgICAgICAgICBjcm9wOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSlcbiAgICApO1xuXG4gICAgYXNzZXJ0Lm9rKFxuICAgICAgdmFsaWRhdGUoe1xuICAgICAgICB0cmFuc2Zvcm1hdGlvbnM6IHtcbiAgICAgICAgICBjaXJjbGU6IGZhbHNlLFxuICAgICAgICAgIHJvdGF0ZTogZmFsc2UsXG4gICAgICAgICAgY3JvcDoge1xuICAgICAgICAgICAgZm9yY2U6IHRydWUsXG4gICAgICAgICAgICBhc3BlY3RSYXRpbzogMSAvIDIsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0pXG4gICAgKTtcblxuICAgIGFzc2VydEZhaWwoXG4gICAgICB2YWxpZGF0ZSh7XG4gICAgICAgIHRyYW5zZm9ybWF0aW9uczoge1xuICAgICAgICAgIHRlc3Q6IDEyMyxcbiAgICAgICAgfSxcbiAgICAgIH0pXG4gICAgKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBjdXN0b21UZXh0IHBhcmFtJywgKCkgPT4ge1xuICAgIGFzc2VydC5vayhcbiAgICAgIHZhbGlkYXRlKHtcbiAgICAgICAgY3VzdG9tVGV4dDoge1xuICAgICAgICAgIHNvbWV0ZXN0OiAndGVzdHRleHQnLFxuICAgICAgICB9LFxuICAgICAgfSlcbiAgICApO1xuICAgIGFzc2VydEZhaWwodmFsaWRhdGUoeyBjdXN0b21UZXh0OiBbJ3Rlc3QnLCAndHMxJ10gfSkpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHZhbGlkYXRlIGN1c3RvbUF1dGhUZXh0IHBhcmFtJywgKCkgPT4ge1xuICAgIGFzc2VydC5vayhcbiAgICAgIHZhbGlkYXRlKHtcbiAgICAgICAgY3VzdG9tQXV0aFRleHQ6IHtcbiAgICAgICAgICB0ZXN0OiB7XG4gICAgICAgICAgICB0b3A6ICd0ZXN0JyxcbiAgICAgICAgICAgIGJvdHRvbTogJ3Rlc3QyJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSlcbiAgICApO1xuXG4gICAgYXNzZXJ0RmFpbChcbiAgICAgIHZhbGlkYXRlKHtcbiAgICAgICAgY3VzdG9tQXV0aFRleHQ6IHtcbiAgICAgICAgICB0ZXN0OiB7XG4gICAgICAgICAgICB0b3A6ICd0ZXN0JyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSlcbiAgICApO1xuXG4gICAgYXNzZXJ0RmFpbChcbiAgICAgIHZhbGlkYXRlKHtcbiAgICAgICAgY3VzdG9tQXV0aFRleHQ6IHtcbiAgICAgICAgICB0ZXN0OiAnMTIzJyxcbiAgICAgICAgfSxcbiAgICAgIH0pXG4gICAgKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSAnLCAoKSA9PiB7XG4gICAgYXNzZXJ0Lm9rKFxuICAgICAgdmFsaWRhdGUoe1xuICAgICAgICB1cGxvYWRDb25maWc6IHtcbiAgICAgICAgICBwYXJ0U2l6ZTogNSAqIDEwMjQgKiAxMDI0LFxuICAgICAgICAgIGludGVsbGlnZW50OiB0cnVlLFxuICAgICAgICAgIG9uUHJvZ3Jlc3M6ICgpID0+IGNvbnNvbGUsXG4gICAgICAgIH0sXG4gICAgICB9KVxuICAgICk7XG5cbiAgICBhc3NlcnQub2soXG4gICAgICB2YWxpZGF0ZSh7XG4gICAgICAgIHVwbG9hZENvbmZpZzoge1xuICAgICAgICAgIGludGVsbGlnZW50OiAnZmFsbGJhY2snLFxuICAgICAgICB9LFxuICAgICAgfSlcbiAgICApO1xuXG4gICAgYXNzZXJ0RmFpbChcbiAgICAgIHZhbGlkYXRlKHtcbiAgICAgICAgdXBsb2FkQ29uZmlnOiB7XG4gICAgICAgICAgcGFydFNpemU6IDEwMCxcbiAgICAgICAgfSxcbiAgICAgIH0pXG4gICAgKTtcblxuICAgIGFzc2VydEZhaWwoXG4gICAgICB2YWxpZGF0ZSh7XG4gICAgICAgIHVwbG9hZENvbmZpZzoge1xuICAgICAgICAgIHByb2dyZXNzSW50ZXJ2YWw6IDAsXG4gICAgICAgIH0sXG4gICAgICB9KVxuICAgICk7XG5cbiAgICBhc3NlcnRGYWlsKFxuICAgICAgdmFsaWRhdGUoe1xuICAgICAgICB1cGxvYWRDb25maWc6IHtcbiAgICAgICAgICBjb25jdXJyZW5jeTogMCxcbiAgICAgICAgfSxcbiAgICAgIH0pXG4gICAgKTtcbiAgfSk7XG59KTtcbiJdfQ==
