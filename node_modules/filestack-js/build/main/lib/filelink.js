"use strict";
/*
 * Copyright (c) 2018 by Filestack
 * Some rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
var config_1 = require("./../config");
var transforms_schema_1 = require("./../schema/transforms.schema");
var validator_1 = require("./../schema/validator");
var utils_1 = require("./utils");
var filestack_error_1 = require("./../filestack_error");
var debug_1 = require("debug");
var debug = debug_1.default('fs:filelink');
var Align;
(function (Align) {
    Align["left"] = "left";
    Align["right"] = "right";
    Align["center"] = "center";
    Align["bottom"] = "bottom";
    Align["top"] = "top";
    Align["faces"] = "faces";
    Align["middle"] = "middle";
})(Align = exports.Align || (exports.Align = {}));
/**
 * Fit enum
 */
var FitOptions;
(function (FitOptions) {
    FitOptions["clip"] = "clip";
    FitOptions["crop"] = "crop";
    FitOptions["scale"] = "scale";
    FitOptions["max"] = "max";
})(FitOptions = exports.FitOptions || (exports.FitOptions = {}));
/**
 * Blur enum
 */
var BlurMode;
(function (BlurMode) {
    BlurMode["linear"] = "linear";
    BlurMode["gaussian"] = "gaussian";
})(BlurMode = exports.BlurMode || (exports.BlurMode = {}));
/**
 * Shapes enum
 */
var ShapeType;
(function (ShapeType) {
    ShapeType["oval"] = "oval";
    ShapeType["rect"] = "rect";
})(ShapeType = exports.ShapeType || (exports.ShapeType = {}));
/**
 * Noise type enum
 */
var NoiseType;
(function (NoiseType) {
    NoiseType["none"] = "none";
    NoiseType["low"] = "low";
    NoiseType["medium"] = "medium";
    NoiseType["high"] = "high";
})(NoiseType = exports.NoiseType || (exports.NoiseType = {}));
/**
 * Style type enum
 */
var StyleType;
(function (StyleType) {
    StyleType["artwork"] = "artwork";
    StyleType["photo"] = "photo";
})(StyleType = exports.StyleType || (exports.StyleType = {}));
/**
 * Color space enum
 */
var ColorspaceType;
(function (ColorspaceType) {
    ColorspaceType["RGB"] = "RGB";
    ColorspaceType["CMYK"] = "CMYK";
    ColorspaceType["Input"] = "Input";
})(ColorspaceType = exports.ColorspaceType || (exports.ColorspaceType = {}));
/**
 * Crop faces options enum
 */
var CropfacesType;
(function (CropfacesType) {
    CropfacesType["thumb"] = "thumb";
    CropfacesType["crop"] = "crop";
    CropfacesType["fill"] = "fill";
})(CropfacesType = exports.CropfacesType || (exports.CropfacesType = {}));
/**
 * Watermark postion options enum
 */
var ImageWatermarkPosition;
(function (ImageWatermarkPosition) {
    ImageWatermarkPosition["top"] = "top";
    ImageWatermarkPosition["middle"] = "middle";
    ImageWatermarkPosition["bottom"] = "bottom";
    ImageWatermarkPosition["left"] = "left";
    ImageWatermarkPosition["center"] = "center";
    ImageWatermarkPosition["right"] = "right";
})(ImageWatermarkPosition = exports.ImageWatermarkPosition || (exports.ImageWatermarkPosition = {}));
/**
 * SmartCrop options enum
 */
var SmartCropMode;
(function (SmartCropMode) {
    SmartCropMode["face"] = "face";
    SmartCropMode["auto"] = "auto";
})(SmartCropMode = exports.SmartCropMode || (exports.SmartCropMode = {}));
/**
 * Convert to format
 */
var VideoTypes;
(function (VideoTypes) {
    VideoTypes["h264"] = "h264";
    VideoTypes["h264_hi"] = "h264.hi";
    VideoTypes["webm"] = "webm";
    VideoTypes["webm-hi"] = "webm.hi";
    VideoTypes["ogg"] = "ogg";
    VideoTypes["ogg-hi"] = "ogg.hi";
    VideoTypes["hls-variant"] = "hls.variant";
    VideoTypes["mp3"] = "mp3";
    VideoTypes["oga"] = "oga";
    VideoTypes["m4a"] = "m4a";
    VideoTypes["aac"] = "aac";
    VideoTypes["hls"] = "hls.variant.audio";
})(VideoTypes = exports.VideoTypes || (exports.VideoTypes = {}));
var URLScreenshotAgent;
(function (URLScreenshotAgent) {
    URLScreenshotAgent["desktop"] = "desktop";
    URLScreenshotAgent["mobile"] = "mobile";
})(URLScreenshotAgent = exports.URLScreenshotAgent || (exports.URLScreenshotAgent = {}));
var URLScreenshotMode;
(function (URLScreenshotMode) {
    URLScreenshotMode["all"] = "all";
    URLScreenshotMode["window"] = "window";
})(URLScreenshotMode = exports.URLScreenshotMode || (exports.URLScreenshotMode = {}));
var URLScreenshotOrientation;
(function (URLScreenshotOrientation) {
    URLScreenshotOrientation["portrait"] = "portrait";
    URLScreenshotOrientation["landscape"] = "landscape";
})(URLScreenshotOrientation = exports.URLScreenshotOrientation || (exports.URLScreenshotOrientation = {}));
/**
 * Video storage location
 */
var Locations;
(function (Locations) {
    Locations["s3"] = "s3";
    Locations["azure"] = "azure";
    Locations["gcs"] = "gcs";
    Locations["rackspace"] = "rackspace";
    Locations["dropbox"] = "dropbox";
})(Locations = exports.Locations || (exports.Locations = {}));
var VideoAccess;
(function (VideoAccess) {
    VideoAccess["private"] = "private";
    VideoAccess["public"] = "public";
})(VideoAccess = exports.VideoAccess || (exports.VideoAccess = {}));
var VideoAccessMode;
(function (VideoAccessMode) {
    VideoAccessMode["preserve"] = "preserve";
    VideoAccessMode["constrain"] = "constrain";
    VideoAccessMode["letterbox"] = "letterbox";
    VideoAccessMode["pad"] = "pad";
    VideoAccessMode["crop"] = "crop";
})(VideoAccessMode = exports.VideoAccessMode || (exports.VideoAccessMode = {}));
var EnhancePreset;
(function (EnhancePreset) {
    EnhancePreset["auto"] = "auto";
    EnhancePreset["vivid"] = "vivid";
    EnhancePreset["beautify"] = "beautify";
    EnhancePreset["beautifyPlus"] = "beautify_plus";
    EnhancePreset["fixDark"] = "fix_dark";
    EnhancePreset["fixNoise"] = "fix_noise";
    EnhancePreset["fixTint"] = "fix_tint";
    EnhancePreset["outdor"] = "outdoor";
    EnhancePreset["fireworks"] = "fireworks";
})(EnhancePreset = exports.EnhancePreset || (exports.EnhancePreset = {}));
var handleRegexp = /^[\w\-]{20}|wf:\/\/[\w\-\/]{106}$/;
/**
 * Class for handling filelinks. For now its supports all filestack transforms.
 * It outputs transform url or array of transforms
 * @example
 * const link = new Filelink('handle or externalUrl', 'apikey');
 * link.flip().flop().store();
 *
 * console.log(link.toString());
 * // enable base64 support
 * link.setBase64(true)
 *
 * console.log(link.toString());
 *
 * @export
 * @class Filelink
 */
var Filelink = /** @class */ (function () {
    /**
     * Class for generating tranformation urls
     * @param {(string | string[])} source - handle or multiple handles (i.e. for collage)
     * @param {string} [apikey] - your apikey - required for all external sources
     *
     * @memberof Filelink
     */
    function Filelink(source, apikey) {
        /**
         * Applied transforms array
         *
         * @private
         * @memberof Filelink
         */
        this.transforms = [];
        /**
         * Is base64 support is enabled
         *
         * @private
         * @type {boolean}
         * @memberof Filelink
         */
        this.b64 = false;
        /**
         * should use a validator to check params of every task
         * @private
         * @type {boolean}
         * @memberof Filelink
         */
        this.useValidator = true;
        /**
         * Converts array of objects to object
         *
         * @private
         * @example [{name: 'resize', params: {height: 125}}] => {resize: {height: 125}}
         * @param arr - any array
         */
        this.arrayToObject = function (array, nameKey, dataKey) {
            if (array === void 0) { array = []; }
            return array.reduce(function (obj, item) {
                obj[item[nameKey]] = item[dataKey];
                return obj;
            }, {});
        };
        this.apikey = apikey;
        this.setSource(source);
    }
    /**
     * Enable new base64 link support to avoid problems with special chars in link
     *
     * @param {boolean} flag
     * @returns
     * @memberof Filelink
     */
    Filelink.prototype.setBase64 = function (flag) {
        this.b64 = flag;
        return this;
    };
    /**
     * Switch the useValidator flag
     *
     * @param {boolean} flag
     * @returns
     * @memberof Filelink
     */
    Filelink.prototype.setUseValidator = function (flag) {
        this.useValidator = flag;
        return this;
    };
    /**
     * Set cname for transformation link
     *
     * @param {string} cname
     * @returns
     * @memberof Filelink
     */
    Filelink.prototype.setCname = function (cname) {
        this.cname = cname;
        return this;
    };
    /**
     * Set custom domain. Used for test purpose. It will be removed when after client.transform
     *
     * @param {string} domain
     * @returns
     * @memberof Filelink
     */
    Filelink.prototype.setCustomDomain = function (domain) {
        this.customDomain = domain;
        return this;
    };
    Filelink.prototype.setSource = function (source) {
        this.source = source;
        var isExternal = this.isSourceExternal();
        debug("Source " + source + " - isExternal? " + isExternal);
        if (isExternal && !this.apikey) {
            throw new filestack_error_1.FilestackError('External sources requires apikey to handle transforms');
        }
        if (!isExternal && typeof this.source === 'string' && !handleRegexp.test(this.source) && this.source.indexOf('filestackcontent') === -1) {
            throw new filestack_error_1.FilestackError('Invalid filestack source provided');
        }
    };
    /**
     * Returns JSONSchema form transformations params
     *
     * @returns
     * @memberof Filelink
     */
    Filelink.prototype.getValidationSchema = function () {
        return transforms_schema_1.TransformSchema;
    };
    /**
     * Returns transformations in JSON format
     *
     * @returns
     * @memberof Filelink
     */
    Filelink.prototype.getTransformations = function () {
        if (this.useValidator) {
            this.validateTasks(this.transforms);
        }
        return this.transforms;
    };
    /**
     * Returns transform url
     *
     * @returns
     * @memberof Filelink
     */
    Filelink.prototype.toString = function () {
        var returnUrl = [];
        returnUrl.push(this.getCdnHost());
        if (this.useValidator) {
            this.validateTasks(this.transforms);
        }
        if (this.apikey) {
            returnUrl.push(this.apikey);
        }
        var transformsString = this.generateTransformString();
        var source = this.source;
        if (this.b64) {
            if (this.transforms.length > 0) {
                transformsString = "b64/" + utils_1.b64(JSON.stringify(this.transforms), true);
            }
            if (Array.isArray(source)) {
                source = this.arrayToString(source);
            }
            source = "b64://" + utils_1.b64(source, true);
        }
        else {
            if (Array.isArray(source)) {
                source = this.arrayToString(source);
            }
            else {
                source = this.escapeValue(source);
            }
        }
        if (transformsString.length) {
            returnUrl.push(transformsString);
        }
        returnUrl.push(source);
        return returnUrl.join('/');
    };
    /**
     * Add task and validate
     *
     * @param {string} name
     * @param {*} [params]
     * @returns
     * @memberof Filelink
     */
    Filelink.prototype.addTask = function (name, params) {
        debug_1.default("Add task  " + name + " with params %O", params);
        if (name !== 'cache' && typeof params === 'boolean') {
            if (!params) {
                return this;
            }
            else {
                params = undefined;
            }
        }
        else if (typeof params === 'object' && !Object.keys(params).length) {
            params = undefined;
        }
        this.transforms.push({ name: name, params: params });
        return this;
    };
    /**
     * Returns all tasks added for transformation
     *
     * @memberof Filelink
     */
    Filelink.prototype.getTasks = function () {
        return this.transforms;
    };
    /**
     * Cleanup transformations on filelink
     *
     * @returns
     * @memberof Filelink
     */
    Filelink.prototype.reset = function () {
        this.transforms = [];
        return this;
    };
    /**
     * Transformations part
     */
    /**
     * Add autoimage transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#auto-image-conversion
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.autoImage = function () {
        return this.addTask('auto_image', true);
    };
    /**
     * Adds flip transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#flip
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.flip = function () {
        return this.addTask('flip', true);
    };
    /**
     * Adds flop transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#flop
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.flop = function () {
        return this.addTask('flop', true);
    };
    /**
     * Adds imagesize transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#image-size
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.imagesize = function () {
        return this.addTask('imagesize', true);
    };
    /**
     * Adds noMetadata transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#strip-metadata
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.noMetadata = function () {
        return this.addTask('no_metadata', true);
    };
    /**
     * Adds Progressive JPEG transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#progressive-jpeg
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.pjpg = function (params) {
        return this.addTask('pjpg', params);
    };
    /**
     * Adds imagesize transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#smart-crop
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.smartCrop = function (params) {
        return this.addTask('smart_crop', params);
    };
    /**
     * Adds watermart transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#watermark
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.watermark = function (params) {
        return this.addTask('watermark', params);
    };
    /**
     * Adds enhance transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#enhance
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.enhance = function (params) {
        return this.addTask('enhance', params || true);
    };
    /**
     * Add security to link
     *
     * @see https://www.filestack.com/docs/api/processing/#redeye
     * @returns
     * @memberof Filelink
     */
    Filelink.prototype.redeye = function () {
        return this.addTask('redeye', true);
    };
    /**
     * Add monochrome transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#monochrome
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.monochrome = function () {
        return this.addTask('monochrome', true);
    };
    /**
     * Add compress transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#compress
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.compress = function (params) {
        return this.addTask('compress', params || true);
    };
    /**
     * Adds negative transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#negative
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.negative = function () {
        return this.addTask('negative', true);
    };
    /**
     * Adds tags transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#tags
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.tags = function () {
        return this.addTask('tags', true);
    };
    /**
     * Adds sfw transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#sfw
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.sfw = function () {
        return this.addTask('sfw', true);
    };
    /**
     * Add animate transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#animate-images-to-gif
     * @param params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.animate = function (params) {
        return this.addTask('animate', params);
    };
    /**
     * Adds store transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#store
     * @param {(StoreParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.store = function (params) {
        return this.addTask('store', params);
    };
    /**
     * Adds cache transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#cache
     * @param {(CacheParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.cache = function (params) {
        return this.addTask('cache', params);
    };
    /**
     * Adds resize transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#resize
     * @param {ResizeParams} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.resize = function (params) {
        return this.addTask('resize', params);
    };
    /**
     * Adds crop transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#crop
     * @param {CropParams} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.crop = function (params) {
        return this.addTask('crop', params);
    };
    /**
     * Adds rotate transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#rotate
     * @param {RotateParams} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.rotate = function (params) {
        return this.addTask('rotate', params);
    };
    /**
     * Adds detect_faces transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#facial-detection
     * @param {(DetectFacesParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.detectFaces = function (params) {
        return this.addTask('detect_faces', params);
    };
    /**
     * Adds crop faces transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#crop-faces
     * @param {CropFacesParams} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.cropFaces = function (params) {
        return this.addTask('crop_faces', params);
    };
    /**
     * Adds pixelate faces transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#pixelate-faces
     * @param {PixelateFacesParams} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.pixelateFaces = function (params) {
        return this.addTask('pixelate_faces', params);
    };
    /**
     * Adds blur faces transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#blur-faces
     * @param {BlurFacesParams} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.blurFaces = function (params) {
        return this.addTask('blur_faces', params);
    };
    /**
     * Adds rounded corners transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#rounded-corners
     * @param {(RoundedCornersParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.roundedCorners = function (params) {
        return this.addTask('rounded_corners', params);
    };
    /**
     * Adds polaroid transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#polaroid
     * @param {(PolaroidParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.polaroid = function (params) {
        return this.addTask('polaroid', params);
    };
    /**
     * Adds vignette transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#vignette
     * @param {(VignetteParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.vignette = function (params) {
        return this.addTask('vignette', params);
    };
    /**
     * Adds torn edges transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#torn-edges
     * @param {(TornEdgesParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.tornEdges = function (params) {
        return this.addTask('torn_edges', params);
    };
    /**
     * Adds shadow transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#shadow
     * @param {(ShadowParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.shadow = function (params) {
        return this.addTask('shadow', params);
    };
    /**
     * Adds circle transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#circle
     * @param {(CircleParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.circle = function (params) {
        return this.addTask('circle', params);
    };
    /**
     * Adds border transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#border
     * @param {(BorderParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.border = function (params) {
        return this.addTask('border', params);
    };
    /**
     * Adds sharpen transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#sharpen
     * @param {(SharpenParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.sharpen = function (params) {
        return this.addTask('sharpen', params);
    };
    /**
     * Adds blur transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#blur
     * @param {(BlurParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.blur = function (params) {
        return this.addTask('blur', params);
    };
    /**
     * Adds blackwhite transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#blackwhite
     * @param {(BlackwhiteParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.blackwhite = function (params) {
        return this.addTask('blackwhite', params);
    };
    /**
     * Adds sepia transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#sepia
     * @param {(SepiaParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.sepia = function (params) {
        return this.addTask('sepia', params);
    };
    /**
     * Adds pixelate transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#pixelate
     * @param {(PixelateParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.pixelate = function (params) {
        return this.addTask('pixelate', params);
    };
    /**
     * Adds oilpaint transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#oil-paint
     * @param {(OilPaintParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.oilPaint = function (params) {
        return this.addTask('oil_paint', params);
    };
    /**
     * Adds modulate transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#modulate
     * @param {(ModulateParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.modulate = function (params) {
        return this.addTask('modulate', params);
    };
    /**
     * Adds partial pixelate transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#partial-pixelate
     * @param {PartialPixelateParams} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.partialPixelate = function (params) {
        return this.addTask('partial_pixelate', params);
    };
    /**
     * Adds partial blur transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#partial-blur
     * @param {PartialBlurParams} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.partialBlur = function (params) {
        return this.addTask('partial_blur', params);
    };
    /**
     * Adds collage transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#collage
     * @param {CollageParams} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.collage = function (params) {
        return this.addTask('collage', params);
    };
    /**
     * Adds upscale transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#upscale
     * @param {(UpscaleParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.upscale = function (params) {
        return this.addTask('upscale', params);
    };
    /**
     * Adds ascii transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#ascii
     * @param {(AsciiParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.ascii = function (params) {
        return this.addTask('ascii', params);
    };
    /**
     * Adds quality transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#quality
     * @param {QualityParams} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.quality = function (params) {
        return this.addTask('quality', params);
    };
    /**
     * Adds security transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#security
     * @param {SecurityParams} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.security = function (params) {
        return this.addTask('security', params);
    };
    /**
     * Adds output transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#output
     * @param {OutputParams} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.output = function (params) {
        return this.addTask('output', params);
    };
    /**
     * Adds video convert transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#video-convert
     * @param {VideoConvertParams} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.videoConvert = function (params) {
        return this.addTask('video_convert', params);
    };
    /**
     * Adds URLScreenshot transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#urlscreenshot
     * @param {(URLScreenshotParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.URLScreenshot = function (params) {
        return this.addTask('urlscreenshot', params);
    };
    /**
     * Adds pdfinfo transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#pdfinfo
     * @param {(PdfInfoParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.PDFInfo = function (params) {
        return this.addTask('pdfinfo', params);
    };
    /**
     * Adds pdfconvert transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#pdfconvert
     * @param {(PdfConvertParams | boolean)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.PDFConvert = function (params) {
        return this.addTask('pdfconvert', params);
    };
    /**
     * Adds fallback transformation
     *
     * @see https://www.filestack.com/docs/api/processing/#fallback
     * @param {(FallbackParams)} params
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.fallback = function (params) {
        return this.addTask('fallback', params);
    };
    /**
     * Add zip transformation which create a zip package on files
     * used on actual context
     *
     * @see https://www.filestack.com/docs/api/processing/#zip
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.zip = function () {
        return this.addTask('zip', true);
    };
    /**
     * Add task which minify a css file
     *
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.minifyCss = function (params) {
        return this.addTask('minify_css', params);
    };
    /**
     * Add task which minify a javascript file.
     * For better handling of 'targets' param, use with b64 flag enabled.
     *
     * @returns this
     * @memberof Filelink
     */
    Filelink.prototype.minifyJs = function (params) {
        return this.addTask('minify_js', params);
    };
    /**
     * Checks if source is external
     *
     * @private
     * @returns {boolean}
     * @memberof Filelink
     */
    Filelink.prototype.isSourceExternal = function () {
        if (!this.source) {
            throw new filestack_error_1.FilestackError('Source not Set');
        }
        var toTest = Array.isArray(this.source) ? this.source : [this.source];
        for (var i in toTest) {
            /* istanbul ignore next */
            if (!toTest.hasOwnProperty(i)) {
                continue;
            }
            if (toTest[i].indexOf('src:') === 0 || (toTest[i].indexOf('http') === 0 && toTest[i].indexOf('filestackcontent') === -1)) {
                return true;
            }
        }
        return false;
    };
    /**
     * Validate every task against schema
     *
     * @private
     * @param {object[]} transformations - object which contain all transformations
     * @returns {void}
     * @memberof Filelink
     */
    Filelink.prototype.validateTasks = function (transformations) {
        var res = Filelink.validator(this.arrayToObject(transformations, 'name', 'params'));
        if (res.errors.length) {
            throw new filestack_error_1.FilestackError("Params validation error", res.errors, filestack_error_1.FilestackErrorType.VALIDATION);
        }
        return;
    };
    /**
     * Returns correct cdn url with cname support
     *
     * @private
     * @returns {string}
     * @memberof Filelink
     */
    Filelink.prototype.getCdnHost = function () {
        var urls = Object.assign({}, config_1.config.urls);
        if (this.customDomain) {
            urls.cdnUrl = this.customDomain;
        }
        urls = utils_1.resolveHost(urls, this.cname);
        return urls.cdnUrl;
    };
    /**
     * Returns applied transformations as string
     *
     * @private
     * @returns {string}
     * @memberof Filelink
     */
    Filelink.prototype.generateTransformString = function () {
        var _this = this;
        var transforms = [];
        this.transforms.forEach(function (el) {
            transforms.push(_this.optionToString(el.name, el.params));
        });
        return transforms.join('/');
    };
    /**
     * Flatten transformation option to string
     *
     * @private
     * @example {resize:{width: 100,height: 200}} => resize=width:100,height:200
     * @param key - option key
     * @param values - option params
     */
    Filelink.prototype.optionToString = function (key, values) {
        var _this = this;
        var optionsString = [];
        if (typeof values === 'undefined') {
            return key;
        }
        // if we just want to enable feature
        if (typeof values === 'boolean') {
            if (!values && key === 'cache') {
                return 'cache=false';
            }
            return key;
        }
        Object.keys(values).forEach(function (i) {
            if (Array.isArray(values[i])) {
                optionsString.push(i + ":" + _this.arrayToString(values[i]));
                return;
            }
            optionsString.push(i + ":" + _this.escapeValue(values[i]));
        });
        return key + "=" + optionsString.join(',');
    };
    /**
     * Escape params values
     *
     * @private
     * @param {string} value
     * @returns {string}
     * @memberof Filelink
     */
    Filelink.prototype.escapeValue = function (value) {
        if (typeof value !== 'string') {
            return value;
        }
        if (value.indexOf('/') > -1 || value.indexOf(',') > -1) {
            return "\"" + value + "\"";
        }
        return value;
    };
    /**
     * Converts nested arrays to string
     *
     * @private
     * @example [1,2, [2,3]] => "[1,2, [2,3]]"
     * @param arr - any array
     */
    Filelink.prototype.arrayToString = function (arr) {
        var _this = this;
        var toReturn = arr.map(function (el) {
            if (Array.isArray(el)) {
                return _this.arrayToString(el);
            }
            return _this.escapeValue(el);
        });
        return "[" + toReturn + "]";
    };
    /**
     * Validator instance
     *
     * @private
     * @memberof Filelink
     */
    Filelink.validator = validator_1.getValidator(transforms_schema_1.TransformSchema);
    return Filelink;
}());
exports.Filelink = Filelink;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9saWIvZmlsZWxpbmsudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7Ozs7R0FlRzs7QUFFSCxzQ0FBcUM7QUFDckMsbUVBQWdFO0FBQ2hFLG1EQUFxRDtBQUNyRCxpQ0FBMkM7QUFDM0Msd0RBQTBFO0FBQzFFLCtCQUEwQjtBQUUxQixJQUFNLEtBQUssR0FBRyxlQUFLLENBQUMsYUFBYSxDQUFDLENBQUM7QUFFbkMsSUFBWSxLQVFYO0FBUkQsV0FBWSxLQUFLO0lBQ2Ysc0JBQWEsQ0FBQTtJQUNiLHdCQUFlLENBQUE7SUFDZiwwQkFBaUIsQ0FBQTtJQUNqQiwwQkFBaUIsQ0FBQTtJQUNqQixvQkFBVyxDQUFBO0lBQ1gsd0JBQWUsQ0FBQTtJQUNmLDBCQUFpQixDQUFBO0FBQ25CLENBQUMsRUFSVyxLQUFLLEdBQUwsYUFBSyxLQUFMLGFBQUssUUFRaEI7QUFPRDs7R0FFRztBQUNILElBQVksVUFLWDtBQUxELFdBQVksVUFBVTtJQUNwQiwyQkFBYSxDQUFBO0lBQ2IsMkJBQWEsQ0FBQTtJQUNiLDZCQUFlLENBQUE7SUFDZix5QkFBVyxDQUFBO0FBQ2IsQ0FBQyxFQUxXLFVBQVUsR0FBVixrQkFBVSxLQUFWLGtCQUFVLFFBS3JCO0FBRUQ7O0dBRUc7QUFDSCxJQUFZLFFBR1g7QUFIRCxXQUFZLFFBQVE7SUFDbEIsNkJBQWlCLENBQUE7SUFDakIsaUNBQXFCLENBQUE7QUFDdkIsQ0FBQyxFQUhXLFFBQVEsR0FBUixnQkFBUSxLQUFSLGdCQUFRLFFBR25CO0FBRUQ7O0dBRUc7QUFDSCxJQUFZLFNBR1g7QUFIRCxXQUFZLFNBQVM7SUFDbkIsMEJBQWEsQ0FBQTtJQUNiLDBCQUFhLENBQUE7QUFDZixDQUFDLEVBSFcsU0FBUyxHQUFULGlCQUFTLEtBQVQsaUJBQVMsUUFHcEI7QUFFRDs7R0FFRztBQUNILElBQVksU0FLWDtBQUxELFdBQVksU0FBUztJQUNuQiwwQkFBYSxDQUFBO0lBQ2Isd0JBQVcsQ0FBQTtJQUNY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QWxpQ0Q7Ozs7O09BS0c7SUFDWSxrQkFBUyxHQUFHLHdCQUFZLENBQUMsbUNBQWUsQ0FBQyxDQUFDO0lBMmlDM0QsZUFBQztDQWxqQ0QsQUFrakNDLElBQUE7QUFsakNZLDRCQUFRIiwiZmlsZSI6ImxpYi9maWxlbGluay5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTggYnkgRmlsZXN0YWNrXG4gKiBTb21lIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgY29uZmlnIH0gZnJvbSAnLi8uLi9jb25maWcnO1xuaW1wb3J0IHsgVHJhbnNmb3JtU2NoZW1hIH0gZnJvbSAnLi8uLi9zY2hlbWEvdHJhbnNmb3Jtcy5zY2hlbWEnO1xuaW1wb3J0IHsgZ2V0VmFsaWRhdG9yIH0gZnJvbSAnLi8uLi9zY2hlbWEvdmFsaWRhdG9yJztcbmltcG9ydCB7IHJlc29sdmVIb3N0LCBiNjQgfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IEZpbGVzdGFja0Vycm9yLCBGaWxlc3RhY2tFcnJvclR5cGUgfSBmcm9tICcuLy4uL2ZpbGVzdGFja19lcnJvcic7XG5pbXBvcnQgRGVidWcgZnJvbSAnZGVidWcnO1xuXG5jb25zdCBkZWJ1ZyA9IERlYnVnKCdmczpmaWxlbGluaycpO1xuXG5leHBvcnQgZW51bSBBbGlnbiB7XG4gIGxlZnQgPSAnbGVmdCcsXG4gIHJpZ2h0ID0gJ3JpZ2h0JyxcbiAgY2VudGVyID0gJ2NlbnRlcicsXG4gIGJvdHRvbSA9ICdib3R0b20nLFxuICB0b3AgPSAndG9wJyxcbiAgZmFjZXMgPSAnZmFjZXMnLFxuICBtaWRkbGUgPSAnbWlkZGxlJyxcbn1cblxuLyoqXG4gKiBBbGlnblxuICovXG5leHBvcnQgdHlwZSBBbGlnbk9wdGlvbnMgPSBBbGlnbiB8IFtBbGlnbi50b3AgfCBBbGlnbi5taWRkbGUgfCBBbGlnbi5ib3R0b20sIEFsaWduLmxlZnQgfCBBbGlnbi5jZW50ZXIgfCBBbGlnbi5yaWdodF07XG5cbi8qKlxuICogRml0IGVudW1cbiAqL1xuZXhwb3J0IGVudW0gRml0T3B0aW9ucyB7XG4gIGNsaXAgPSAnY2xpcCcsXG4gIGNyb3AgPSAnY3JvcCcsXG4gIHNjYWxlID0gJ3NjYWxlJyxcbiAgbWF4ID0gJ21heCcsXG59XG5cbi8qKlxuICogQmx1ciBlbnVtXG4gKi9cbmV4cG9ydCBlbnVtIEJsdXJNb2RlIHtcbiAgbGluZWFyID0gJ2xpbmVhcicsXG4gIGdhdXNzaWFuID0gJ2dhdXNzaWFuJyxcbn1cblxuLyoqXG4gKiBTaGFwZXMgZW51bVxuICovXG5leHBvcnQgZW51bSBTaGFwZVR5cGUge1xuICBvdmFsID0gJ292YWwnLFxuICByZWN0ID0gJ3JlY3QnLFxufVxuXG4vKipcbiAqIE5vaXNlIHR5cGUgZW51bVxuICovXG5leHBvcnQgZW51bSBOb2lzZVR5cGUge1xuICBub25lID0gJ25vbmUnLFxuICBsb3cgPSAnbG93JyxcbiAgbWVkaXVtID0gJ21lZGl1bScsXG4gIGhpZ2ggPSAnaGlnaCcsXG59XG5cbi8qKlxuICogU3R5bGUgdHlwZSBlbnVtXG4gKi9cbmV4cG9ydCBlbnVtIFN0eWxlVHlwZSB7XG4gIGFydHdvcmsgPSAnYXJ0d29yaycsXG4gIHBob3RvID0gJ3Bob3RvJyxcbn1cblxuLyoqXG4gKiBDb2xvciBzcGFjZSBlbnVtXG4gKi9cbmV4cG9ydCBlbnVtIENvbG9yc3BhY2VUeXBlIHtcbiAgUkdCID0gJ1JHQicsXG4gIENNWUsgPSAnQ01ZSycsXG4gIElucHV0ID0gJ0lucHV0Jyxcbn1cblxuLyoqXG4gKiBDcm9wIGZhY2VzIG9wdGlvbnMgZW51bVxuICovXG5leHBvcnQgZW51bSBDcm9wZmFjZXNUeXBlIHtcbiAgdGh1bWIgPSAndGh1bWInLFxuICBjcm9wID0gJ2Nyb3AnLFxuICBmaWxsID0gJ2ZpbGwnLFxufVxuXG4vKipcbiAqIFdhdGVybWFyayBwb3N0aW9uIG9wdGlvbnMgZW51bVxuICovXG5leHBvcnQgZW51bSBJbWFnZVdhdGVybWFya1Bvc2l0aW9uIHtcbiAgdG9wID0gJ3RvcCcsXG4gIG1pZGRsZSA9ICdtaWRkbGUnLFxuICBib3R0b20gPSAnYm90dG9tJyxcbiAgbGVmdCA9ICdsZWZ0JyxcbiAgY2VudGVyID0gJ2NlbnRlcicsXG4gIHJpZ2h0ID0gJ3JpZ2h0Jyxcbn1cblxuLyoqXG4gKiBTbWFydENyb3Agb3B0aW9ucyBlbnVtXG4gKi9cbmV4cG9ydCBlbnVtIFNtYXJ0Q3JvcE1vZGUge1xuICBmYWNlID0gJ2ZhY2UnLFxuICBhdXRvID0gJ2F1dG8nLFxufVxuXG4vKipcbiAqIENvbnZlcnQgdG8gZm9ybWF0XG4gKi9cbmV4cG9ydCBlbnVtIFZpZGVvVHlwZXMge1xuICBoMjY0ID0gJ2gyNjQnLFxuICBoMjY0X2hpID0gJ2gyNjQuaGknLFxuICB3ZWJtID0gJ3dlYm0nLFxuICAnd2VibS1oaScgPSAnd2VibS5oaScsXG4gIG9nZyA9ICdvZ2cnLFxuICAnb2dnLWhpJyA9ICdvZ2cuaGknLFxuICAnaGxzLXZhcmlhbnQnID0gJ2hscy52YXJpYW50JyxcbiAgbXAzID0gJ21wMycsXG4gIG9nYSA9ICdvZ2EnLFxuICBtNGEgPSAnbTRhJyxcbiAgYWFjID0gJ2FhYycsXG4gIGhscyA9ICdobHMudmFyaWFudC5hdWRpbycsXG59XG5cbmV4cG9ydCBlbnVtIFVSTFNjcmVlbnNob3RBZ2VudCB7XG4gIGRlc2t0b3AgPSAnZGVza3RvcCcsXG4gIG1vYmlsZSA9ICdtb2JpbGUnLFxufVxuXG5leHBvcnQgZW51bSBVUkxTY3JlZW5zaG90TW9kZSB7XG4gIGFsbCA9ICdhbGwnLFxuICB3aW5kb3cgPSAnd2luZG93Jyxcbn1cblxuZXhwb3J0IGVudW0gVVJMU2NyZWVuc2hvdE9yaWVudGF0aW9uIHtcbiAgcG9ydHJhaXQgPSAncG9ydHJhaXQnLFxuICBsYW5kc2NhcGUgPSAnbGFuZHNjYXBlJyxcbn1cblxuLyoqXG4gKiBWaWRlbyBzdG9yYWdlIGxvY2F0aW9uXG4gKi9cbmV4cG9ydCBlbnVtIExvY2F0aW9ucyB7XG4gIHMzID0gJ3MzJyxcbiAgYXp1cmUgPSAnYXp1cmUnLFxuICBnY3MgPSAnZ2NzJyxcbiAgcmFja3NwYWNlID0gJ3JhY2tzcGFjZScsXG4gIGRyb3Bib3ggPSAnZHJvcGJveCcsXG59XG5cbmV4cG9ydCBlbnVtIFZpZGVvQWNjZXNzIHtcbiAgcHJpdmF0ZSA9ICdwcml2YXRlJyxcbiAgcHVibGljID0gJ3B1YmxpYycsXG59XG5cbmV4cG9ydCBlbnVtIFZpZGVvQWNjZXNzTW9kZSB7XG4gIHByZXNlcnZlID0gJ3ByZXNlcnZlJyxcbiAgY29uc3RyYWluID0gJ2NvbnN0cmFpbicsXG4gIGxldHRlcmJveCA9ICdsZXR0ZXJib3gnLFxuICBwYWQgPSAncGFkJyxcbiAgY3JvcCA9ICdjcm9wJyxcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdG9yZUJhc2VQYXJhbXMge1xuICBsb2NhdGlvbj86IHN0cmluZztcbiAgcGF0aD86IHN0cmluZztcbiAgY29udGFpbmVyPzogc3RyaW5nO1xuICByZWdpb24/OiBzdHJpbmc7XG4gIGFjY2Vzcz86IHN0cmluZztcbiAgZGlzYWJsZVN0b3JhZ2VLZXk/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIEF2YWlsYWJsZSBvcHRpb25zIGZvciBzdG9yZSB0cmFuc2Zvcm1hdGlvbnNcbiAqXG4gKiBAZXhwb3J0XG4gKiBAaW50ZXJmYWNlIFN0b3JlUGFyYW1zXG4gKi9cbmV4cG9ydCB0eXBlIFN0b3JlUGFyYW1zID0gU3RvcmVCYXNlUGFyYW1zICYge1xuICBmaWxlbmFtZT86IHN0cmluZztcbiAgYmFzZTY0ZGVjb2RlPzogYm9vbGVhbjtcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgQW5pbWF0aW9uUGFyYW1zIHtcbiAgZGVsYXk/OiBudW1iZXI7XG4gIGxvb3A/OiBudW1iZXI7XG4gIHdpZHRoPzogbnVtYmVyO1xuICBoZWlnaHQ/OiBudW1iZXI7XG4gIGZpdD86IEZpdE9wdGlvbnM7XG4gIGFsaWduPzogQWxpZ25PcHRpb25zO1xuICBiYWNrZ3JvdW5kPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlc2l6ZVBhcmFtcyB7XG4gIHdpZHRoPzogbnVtYmVyO1xuICBoZWlnaHQ/OiBudW1iZXI7XG4gIGZpdD86IEZpdE9wdGlvbnM7XG4gIGFsaWduPzogQWxpZ25PcHRpb25zO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENyb3BQYXJhbXMge1xuICBkaW06IFtudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXJdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJvdGF0ZVBhcmFtcyB7XG4gIGRlZzogbnVtYmVyIHwgc3RyaW5nO1xuICBjb2xvcj86IHN0cmluZztcbiAgYmFja2dyb3VuZD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEZXRlY3RGYWNlc1BhcmFtcyB7XG4gIG1pbnNpemU/OiBudW1iZXI7XG4gIG1heHNpemU/OiBudW1iZXI7XG4gIGNvbG9yPzogc3RyaW5nO1xuICBleHBvcnQ/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENyb3BGYWNlc1BhcmFtcyB7XG4gIG1vZGU/OiBDcm9wZmFjZXNUeXBlO1xuICB3aWR0aD86IG51bWJlcjtcbiAgaGVpZ2h0PzogbnVtYmVyO1xuICBmYWNlcz86IG51bWJlciB8IHN0cmluZztcbiAgYnVmZmVyPzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBpeGVsYXRlRmFjZXNQYXJhbXMge1xuICBmYWNlcz86IG51bWJlciB8IHN0cmluZztcbiAgbWluc2l6ZT86IG51bWJlcjtcbiAgbWF4c2l6ZT86IG51bWJlcjtcbiAgYnVmZmVyPzogbnVtYmVyO1xuICBhbW91bnQ/OiBudW1iZXI7XG4gIGJsdXI/OiBudW1iZXI7XG4gIHR5cGU/OiBTaGFwZVR5cGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmx1ckZhY2VzUGFyYW1zIHtcbiAgZmFjZXM/OiBudW1iZXIgfCBzdHJpbmc7XG4gIG1pbnNpemU/OiBudW1iZXI7XG4gIG1heHNpemU/OiBudW1iZXI7XG4gIGJ1ZmZlcj86IG51bWJlcjtcbiAgYW1vdW50PzogbnVtYmVyO1xuICBibHVyPzogbnVtYmVyO1xuICB0eXBlPzogU2hhcGVUeXBlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJvdW5kZWRDb3JuZXJzUGFyYW1zIHtcbiAgcmFkaXVzPzogbnVtYmVyO1xuICBibHVyPzogbnVtYmVyO1xuICBiYWNrZ3JvdW5kPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZpZ25ldHRlUGFyYW1zIHtcbiAgYW1vdW50PzogbnVtYmVyO1xuICBibHVybW9kZT86IEJsdXJNb2RlO1xuICBiYWNrZ3JvdW5kPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBvbGFyb2lkUGFyYW1zIHtcbiAgY29sb3I/OiBzdHJpbmc7XG4gIHJvdGF0ZT86IG51bWJlcjtcbiAgYmFja2dyb3VuZD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUb3JuRWRnZXNQYXJhbXMge1xuICBzcHJlYWQ/OiBbbnVtYmVyLCBudW1iZXJdO1xuICBiYWNrZ3JvdW5kPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNoYWRvd1BhcmFtcyB7XG4gIGJsdXI/OiBudW1iZXI7XG4gIG9wYWNpdHk/OiBudW1iZXI7XG4gIHZlY3Rvcj86IFtudW1iZXIsIG51bWJlcl07XG4gIGNvbG9yPzogc3RyaW5nO1xuICBiYWNrZ3JvdW5kPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENpcmNsZVBhcmFtcyB7XG4gIGJhY2tncm91bmQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm9yZGVyUGFyYW1zIHtcbiAgd2lkdGg/OiBudW1iZXI7XG4gIGNvbG9yPzogc3RyaW5nO1xuICBiYWNrZ3JvdW5kPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbXByZXNzUGFyYW1zIHtcbiAgbWV0YWRhdGE/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdhdGVybWFya1BhcmFtcyB7XG4gIGZpbGU6IHN0cmluZztcbiAgc2l6ZT86IG51bWJlcjtcbiAgcG9zaXRpb24/OiBJbWFnZVdhdGVybWFya1Bvc2l0aW9uIHwgSW1hZ2VXYXRlcm1hcmtQb3NpdGlvbltdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFByb2dyZXNzaXZlSnBnUGFyYW1zIHtcbiAgcXVhbGl0eTogbnVtYmVyO1xuICBtZXRhZGF0YTogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTbWFydENyb3BQYXJhbXMge1xuICBtb2RlOiBTbWFydENyb3BNb2RlO1xuICB3aWR0aDogbnVtYmVyO1xuICBoZWlnaHQ6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTaGFycGVuUGFyYW1zIHtcbiAgYW1vdW50OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmx1clBhcmFtcyB7XG4gIGFtb3VudDogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJsYWNrd2hpdGVQYXJhbXMge1xuICB0aHJlc2hvbGQ6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXBpYVBhcmFtcyB7XG4gIHRvbmU6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQaXhlbGF0ZVBhcmFtcyB7XG4gIGFtb3VudDogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9pbFBhaW50UGFyYW1zIHtcbiAgYW1vdW50OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW9kdWxhdGVQYXJhbXMge1xuICBicmlnaHRuZXNzPzogbnVtYmVyO1xuICBodWU/OiBudW1iZXI7XG4gIHNhdHVyYXRpb24/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFydGlhbFBpeGVsYXRlUGFyYW1zIHtcbiAgYW1vdW50PzogbnVtYmVyO1xuICBibHVyPzogbnVtYmVyO1xuICB0eXBlPzogU2hhcGVUeXBlO1xuICBvYmplY3RzPzogW1tudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXJdXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQYXJ0aWFsQmx1clBhcmFtcyB7XG4gIGFtb3VudDogbnVtYmVyO1xuICBibHVyPzogbnVtYmVyO1xuICB0eXBlPzogU2hhcGVUeXBlO1xuICBvYmplY3RzPzogW1tudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXJdXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb2xsYWdlUGFyYW1zIHtcbiAgbWFyZ2luPzogbnVtYmVyO1xuICB3aWR0aD86IG51bWJlcjtcbiAgaGVpZ2h0PzogbnVtYmVyO1xuICBjb2xvcj86IHN0cmluZztcbiAgZml0PzogRml0T3B0aW9ucztcbiAgZmlsZXM6IFtzdHJpbmddO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVwc2NhbGVQYXJhbXMge1xuICB1cHNjYWxlPzogYm9vbGVhbjtcbiAgbm9pc2U/OiBOb2lzZVR5cGU7XG4gIHN0eWxlPzogU3R5bGVUeXBlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFzY2lpUGFyYW1zIHtcbiAgYmFja2dyb3VuZD86IHN0cmluZztcbiAgZm9yZWdyb3VuZD86IHN0cmluZztcbiAgY29sb3JlZD86IGJvb2xlYW47XG4gIHNpemU/OiBudW1iZXI7XG4gIHJldmVyc2U/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFF1YWxpdHlQYXJhbXMge1xuICB2YWx1ZTogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlY3VyaXR5UGFyYW1zIHtcbiAgcG9saWN5OiBzdHJpbmc7XG4gIHNpZ25hdHVyZT86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPdXRwdXRQYXJhbXMge1xuICBmb3JtYXQ6IHN0cmluZztcbiAgY29sb3JzcGFjZT86IHN0cmluZztcbiAgc3RyaXA/OiBib29sZWFuO1xuICBxdWFsaXR5PzogbnVtYmVyO1xuICBwYWdlPzogbnVtYmVyO1xuICBjb21wcmVzcz86IGJvb2xlYW47XG4gIGRlbnNpdHk/OiBudW1iZXI7XG4gIGJhY2tncm91bmQ/OiBzdHJpbmc7XG4gIHNlY3VyZT86IGJvb2xlYW47XG4gIGRvY2luZm8/OiBib29sZWFuO1xuICBwYWdlZm9ybWF0Pzogc3RyaW5nO1xuICBwYWdlb3JpZW50YXRpb24/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2FjaGVQYXJhbXMge1xuICBjYWNoZT86IGJvb2xlYW47XG4gIGV4cGlyeTogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZpZGVvQ29udmVydFBhcmFtcyB7XG4gIGFzcGVjdF9tb2RlOiBWaWRlb0FjY2Vzc01vZGU7XG4gIHByZXNldD86IFZpZGVvVHlwZXM7XG4gIGZvcmNlPzogYm9vbGVhbjtcbiAgdGl0bGU/OiBzdHJpbmc7XG4gIGV4dG5hbWU/OiBzdHJpbmc7XG4gIGZpbGVuYW1lPzogc3RyaW5nO1xuICBsb2NhdGlvbj86IExvY2F0aW9ucztcbiAgcGF0aD86IHN0cmluZztcbiAgYWNjZXNzPzogVmlkZW9BY2Nlc3M7XG4gIGNvbnRhaW5lcj86IHN0cmluZztcbiAgYXVkaW9fYml0cmF0ZT86IG51bWJlcjtcbiAgdXBzY2FsZTogYm9vbGVhbjtcbiAgdmlkZW9fYml0cmF0ZT86IG51bWJlcjtcbiAgYXVkaW9fc2FtcGxlX3JhdGU/OiBudW1iZXI7XG4gIGF1ZGlvX2NoYW5uZWxzPzogbnVtYmVyO1xuICBjbGlwX2xlbmd0aD86IHN0cmluZztcbiAgY2xpcF9vZmZzZXQ/OiBzdHJpbmc7XG4gIHdpZHRoPzogbnVtYmVyO1xuICBoZWlnaHQ/OiBudW1iZXI7XG4gIHR3b19wYXNzPzogYm9vbGVhbjtcbiAgZnBzPzogbnVtYmVyO1xuICBrZXlmcmFtZV9pbnRlcnZhbD86IG51bWJlcjtcbiAgd2F0ZXJtYXJrX3VybD86IHN0cmluZztcbiAgd2F0ZXJtYXJrX3RvcD86IG51bWJlcjtcbiAgd2F0ZXJtYXJrX2JvdHRvbT86IG51bWJlcjtcbiAgd2F0ZXJtYXJrX3JpZ2h0PzogbnVtYmVyO1xuICB3YXRlcm1hcmtfbGVmdD86IG51bWJlcjtcbiAgd2F0ZXJtYXJrX3dpZHRoPzogbnVtYmVyO1xuICB3YXRlcm1hcmtfaGVpZ2h0PzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVSTFNjcmVlbnNob3RQYXJhbXMge1xuICBhZ2VudD86IFVSTFNjcmVlbnNob3RBZ2VudDtcbiAgd2lkdGg/OiBudW1iZXI7XG4gIGhlaWdodD86IG51bWJlcjtcbiAgbW9kZT86IFVSTFNjcmVlbnNob3RNb2RlO1xuICBkZWxheT86IG51bWJlcjtcbiAgb3JpZW50YXRpb24/OiBVUkxTY3JlZW5zaG90T3JpZW50YXRpb247XG4gIGRldmljZT86IHN0cmluZztcbn1cblxuZXhwb3J0IGVudW0gRW5oYW5jZVByZXNldCB7XG4gIGF1dG8gPSAnYXV0bycsXG4gIHZpdmlkID0gJ3ZpdmlkJyxcbiAgYmVhdXRpZnkgPSAnYmVhdXRpZnknLFxuICBiZWF1dGlmeVBsdXMgPSAnYmVhdXRpZnlfcGx1cycsXG4gIGZpeERhcmsgPSAnZml4X2RhcmsnLFxuICBmaXhOb2lzZSA9ICdmaXhfbm9pc2UnLFxuICBmaXhUaW50ID0gJ2ZpeF90aW50JyxcbiAgb3V0ZG9yID0gJ291dGRvb3InLFxuICBmaXJld29ya3MgPSAnZmlyZXdvcmtzJyxcbn1cbmV4cG9ydCBpbnRlcmZhY2UgRW5oYW5jZVBhcmFtcyB7XG4gIHByZXNldD86IEVuaGFuY2VQcmVzZXQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGRmSW5mb1BhcmFtcyB7XG4gIGNvbG9yaW5mbz86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGRmQ29udmVydFBhcmFtcyB7XG4gIHBhZ2VvcmllbnRhdGlvbj86IHN0cmluZztcbiAgcGFnZWZvcm1hdD86IHN0cmluZztcbiAgcGFnZXM/OiAoc3RyaW5nIHwgbnVtYmVyKVtdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZhbGxiYWNrUGFyYW1zIHtcbiAgaGFuZGxlOiBzdHJpbmc7XG4gIGNhY2hlPzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1pbmlmeUNzc1BhcmFtcyB7XG4gIGd6aXA/OiBib29sZWFuO1xuICBsZXZlbD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNaW5pZnlKc1BhcmFtcyB7XG4gIGd6aXA/OiBib29sZWFuO1xuICB1c2VfYmFiZWxfcG9seWZpbGw/OiBib29sZWFuO1xuICBrZWVwX2ZuX25hbWU/OiBib29sZWFuO1xuICBrZWVwX2NsYXNzX25hbWU/OiBib29sZWFuO1xuICBtYW5nbGU/OiBib29sZWFuO1xuICBtZXJnZV92YXJzPzogYm9vbGVhbjtcbiAgcmVtb3ZlX2NvbnNvbGU/OiBib29sZWFuO1xuICByZW1vdmVfdW5kZWZpbmVkPzogYm9vbGVhbjtcbiAgdGFyZ2V0cz86IG51bGwgfCBzdHJpbmc7XG59XG5cbmNvbnN0IGhhbmRsZVJlZ2V4cCA9IC9eW1xcd1xcLV17MjB9fHdmOlxcL1xcL1tcXHdcXC1cXC9dezEwNn0kLztcblxuLyoqXG4gKiBDbGFzcyBmb3IgaGFuZGxpbmcgZmlsZWxpbmtzLiBGb3Igbm93IGl0cyBzdXBwb3J0cyBhbGwgZmlsZXN0YWNrIHRyYW5zZm9ybXMuXG4gKiBJdCBvdXRwdXRzIHRyYW5zZm9ybSB1cmwgb3IgYXJyYXkgb2YgdHJhbnNmb3Jtc1xuICogQGV4YW1wbGVcbiAqIGNvbnN0IGxpbmsgPSBuZXcgRmlsZWxpbmsoJ2hhbmRsZSBvciBleHRlcm5hbFVybCcsICdhcGlrZXknKTtcbiAqIGxpbmsuZmxpcCgpLmZsb3AoKS5zdG9yZSgpO1xuICpcbiAqIGNvbnNvbGUubG9nKGxpbmsudG9TdHJpbmcoKSk7XG4gKiAvLyBlbmFibGUgYmFzZTY0IHN1cHBvcnRcbiAqIGxpbmsuc2V0QmFzZTY0KHRydWUpXG4gKlxuICogY29uc29sZS5sb2cobGluay50b1N0cmluZygpKTtcbiAqXG4gKiBAZXhwb3J0XG4gKiBAY2xhc3MgRmlsZWxpbmtcbiAqL1xuZXhwb3J0IGNsYXNzIEZpbGVsaW5rIHtcbiAgLyoqXG4gICAqIFZhbGlkYXRvciBpbnN0YW5jZVxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIHZhbGlkYXRvciA9IGdldFZhbGlkYXRvcihUcmFuc2Zvcm1TY2hlbWEpO1xuXG4gIC8qKlxuICAgKiBBcHBsaWVkIHRyYW5zZm9ybXMgYXJyYXlcbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBwcml2YXRlIHRyYW5zZm9ybXMgPSBbXTtcblxuICAvKipcbiAgICogSGFuZGxlIG9yIG11bHRpcGxlIGhhbmRsZXMgaW4gYXJyYXlcbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBwcml2YXRlIHNvdXJjZTogc3RyaW5nIHwgc3RyaW5nW107XG5cbiAgLyoqXG4gICAqIEFwcGxpY2F0aW9uIGtleVxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHByaXZhdGUgYXBpa2V5OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIElzIGJhc2U2NCBzdXBwb3J0IGlzIGVuYWJsZWRcbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHR5cGUge2Jvb2xlYW59XG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgcHJpdmF0ZSBiNjQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAvKipcbiAgICogc2hvdWxkIHVzZSBhIHZhbGlkYXRvciB0byBjaGVjayBwYXJhbXMgb2YgZXZlcnkgdGFza1xuICAgKiBAcHJpdmF0ZVxuICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBwcml2YXRlIHVzZVZhbGlkYXRvcjogYm9vbGVhbiA9IHRydWU7XG5cbiAgLyoqXG4gICAqIEN1c3RvbSBDTkFNRVxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHByaXZhdGUgY25hbWU6IHN0cmluZztcblxuICAvKipcbiAgICogT3ZlcndyaXRlIGRvbWFpbiAodGVzdCBwdXJwb3NlcylcbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHR5cGUge3N0cmluZ31cbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBwcml2YXRlIGN1c3RvbURvbWFpbjogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBDbGFzcyBmb3IgZ2VuZXJhdGluZyB0cmFuZm9ybWF0aW9uIHVybHNcbiAgICogQHBhcmFtIHsoc3RyaW5nIHwgc3RyaW5nW10pfSBzb3VyY2UgLSBoYW5kbGUgb3IgbXVsdGlwbGUgaGFuZGxlcyAoaS5lLiBmb3IgY29sbGFnZSlcbiAgICogQHBhcmFtIHtzdHJpbmd9IFthcGlrZXldIC0geW91ciBhcGlrZXkgLSByZXF1aXJlZCBmb3IgYWxsIGV4dGVybmFsIHNvdXJjZXNcbiAgICpcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihzb3VyY2U6IHN0cmluZyB8IHN0cmluZ1tdLCBhcGlrZXk/OiBzdHJpbmcpIHtcbiAgICB0aGlzLmFwaWtleSA9IGFwaWtleTtcbiAgICB0aGlzLnNldFNvdXJjZShzb3VyY2UpO1xuICB9XG5cbiAgLyoqXG4gICAqIEVuYWJsZSBuZXcgYmFzZTY0IGxpbmsgc3VwcG9ydCB0byBhdm9pZCBwcm9ibGVtcyB3aXRoIHNwZWNpYWwgY2hhcnMgaW4gbGlua1xuICAgKlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGZsYWdcbiAgICogQHJldHVybnNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBzZXRCYXNlNjQoZmxhZzogYm9vbGVhbikge1xuICAgIHRoaXMuYjY0ID0gZmxhZztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBTd2l0Y2ggdGhlIHVzZVZhbGlkYXRvciBmbGFnXG4gICAqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gZmxhZ1xuICAgKiBAcmV0dXJuc1xuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHNldFVzZVZhbGlkYXRvcihmbGFnOiBib29sZWFuKSB7XG4gICAgdGhpcy51c2VWYWxpZGF0b3IgPSBmbGFnO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCBjbmFtZSBmb3IgdHJhbnNmb3JtYXRpb24gbGlua1xuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gY25hbWVcbiAgICogQHJldHVybnNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBzZXRDbmFtZShjbmFtZTogc3RyaW5nKSB7XG4gICAgdGhpcy5jbmFtZSA9IGNuYW1lO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCBjdXN0b20gZG9tYWluLiBVc2VkIGZvciB0ZXN0IHB1cnBvc2UuIEl0IHdpbGwgYmUgcmVtb3ZlZCB3aGVuIGFmdGVyIGNsaWVudC50cmFuc2Zvcm1cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGRvbWFpblxuICAgKiBAcmV0dXJuc1xuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHNldEN1c3RvbURvbWFpbihkb21haW46IHN0cmluZykge1xuICAgIHRoaXMuY3VzdG9tRG9tYWluID0gZG9tYWluO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgc2V0U291cmNlKHNvdXJjZTogc3RyaW5nIHwgc3RyaW5nW10pIHtcbiAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblxuICAgIGNvbnN0IGlzRXh0ZXJuYWwgPSB0aGlzLmlzU291cmNlRXh0ZXJuYWwoKTtcblxuICAgIGRlYnVnKGBTb3VyY2UgJHtzb3VyY2V9IC0gaXNFeHRlcm5hbD8gJHtpc0V4dGVybmFsfWApO1xuXG4gICAgaWYgKGlzRXh0ZXJuYWwgJiYgIXRoaXMuYXBpa2V5KSB7XG4gICAgICB0aHJvdyBuZXcgRmlsZXN0YWNrRXJyb3IoJ0V4dGVybmFsIHNvdXJjZXMgcmVxdWlyZXMgYXBpa2V5IHRvIGhhbmRsZSB0cmFuc2Zvcm1zJyk7XG4gICAgfVxuXG4gICAgaWYgKCFpc0V4dGVybmFsICYmIHR5cGVvZiB0aGlzLnNvdXJjZSA9PT0gJ3N0cmluZycgJiYgIWhhbmRsZVJlZ2V4cC50ZXN0KHRoaXMuc291cmNlKSAmJiB0aGlzLnNvdXJjZS5pbmRleE9mKCdmaWxlc3RhY2tjb250ZW50JykgPT09IC0xKSB7XG4gICAgICB0aHJvdyBuZXcgRmlsZXN0YWNrRXJyb3IoJ0ludmFsaWQgZmlsZXN0YWNrIHNvdXJjZSBwcm92aWRlZCcpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIEpTT05TY2hlbWEgZm9ybSB0cmFuc2Zvcm1hdGlvbnMgcGFyYW1zXG4gICAqXG4gICAqIEByZXR1cm5zXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgZ2V0VmFsaWRhdGlvblNjaGVtYSgpIHtcbiAgICByZXR1cm4gVHJhbnNmb3JtU2NoZW1hO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdHJhbnNmb3JtYXRpb25zIGluIEpTT04gZm9ybWF0XG4gICAqXG4gICAqIEByZXR1cm5zXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgZ2V0VHJhbnNmb3JtYXRpb25zKCkge1xuICAgIGlmICh0aGlzLnVzZVZhbGlkYXRvcikge1xuICAgICAgdGhpcy52YWxpZGF0ZVRhc2tzKHRoaXMudHJhbnNmb3Jtcyk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnRyYW5zZm9ybXM7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0cmFuc2Zvcm0gdXJsXG4gICAqXG4gICAqIEByZXR1cm5zXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgdG9TdHJpbmcoKSB7XG4gICAgY29uc3QgcmV0dXJuVXJsID0gW107XG4gICAgcmV0dXJuVXJsLnB1c2godGhpcy5nZXRDZG5Ib3N0KCkpO1xuXG4gICAgaWYgKHRoaXMudXNlVmFsaWRhdG9yKSB7XG4gICAgICB0aGlzLnZhbGlkYXRlVGFza3ModGhpcy50cmFuc2Zvcm1zKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5hcGlrZXkpIHtcbiAgICAgIHJldHVyblVybC5wdXNoKHRoaXMuYXBpa2V5KTtcbiAgICB9XG5cbiAgICBsZXQgdHJhbnNmb3Jtc1N0cmluZyA9IHRoaXMuZ2VuZXJhdGVUcmFuc2Zvcm1TdHJpbmcoKTtcblxuICAgIGxldCBzb3VyY2UgPSB0aGlzLnNvdXJjZTtcblxuICAgIGlmICh0aGlzLmI2NCkge1xuICAgICAgaWYgKHRoaXMudHJhbnNmb3Jtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRyYW5zZm9ybXNTdHJpbmcgPSBgYjY0LyR7YjY0KEpTT04uc3RyaW5naWZ5KHRoaXMudHJhbnNmb3JtcyksIHRydWUpfWA7XG4gICAgICB9XG5cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHNvdXJjZSkpIHtcbiAgICAgICAgc291cmNlID0gdGhpcy5hcnJheVRvU3RyaW5nKHNvdXJjZSk7XG4gICAgICB9XG5cbiAgICAgIHNvdXJjZSA9IGBiNjQ6Ly8ke2I2NChzb3VyY2UsIHRydWUpfWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHNvdXJjZSkpIHtcbiAgICAgICAgc291cmNlID0gdGhpcy5hcnJheVRvU3RyaW5nKHNvdXJjZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzb3VyY2UgPSB0aGlzLmVzY2FwZVZhbHVlKHNvdXJjZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRyYW5zZm9ybXNTdHJpbmcubGVuZ3RoKSB7XG4gICAgICByZXR1cm5VcmwucHVzaCh0cmFuc2Zvcm1zU3RyaW5nKTtcbiAgICB9XG5cbiAgICByZXR1cm5VcmwucHVzaChzb3VyY2UpO1xuICAgIHJldHVybiByZXR1cm5Vcmwuam9pbignLycpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCB0YXNrIGFuZCB2YWxpZGF0ZVxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcGFyYW0geyp9IFtwYXJhbXNdXG4gICAqIEByZXR1cm5zXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgYWRkVGFzayhuYW1lOiBzdHJpbmcsIHBhcmFtcz8pIHtcbiAgICBEZWJ1ZyhgQWRkIHRhc2sgICR7bmFtZX0gd2l0aCBwYXJhbXMgJU9gLCBwYXJhbXMpO1xuXG4gICAgaWYgKG5hbWUgIT09ICdjYWNoZScgJiYgdHlwZW9mIHBhcmFtcyA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICBpZiAoIXBhcmFtcykge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcmFtcyA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBwYXJhbXMgPT09ICdvYmplY3QnICYmICFPYmplY3Qua2V5cyhwYXJhbXMpLmxlbmd0aCkge1xuICAgICAgcGFyYW1zID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHRoaXMudHJhbnNmb3Jtcy5wdXNoKHsgbmFtZSwgcGFyYW1zIH0pO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYWxsIHRhc2tzIGFkZGVkIGZvciB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIGdldFRhc2tzKCkge1xuICAgIHJldHVybiB0aGlzLnRyYW5zZm9ybXM7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYW51cCB0cmFuc2Zvcm1hdGlvbnMgb24gZmlsZWxpbmtcbiAgICpcbiAgICogQHJldHVybnNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICByZXNldCgpIHtcbiAgICB0aGlzLnRyYW5zZm9ybXMgPSBbXTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBUcmFuc2Zvcm1hdGlvbnMgcGFydFxuICAgKi9cblxuICAvKipcbiAgICogQWRkIGF1dG9pbWFnZSB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jYXV0by1pbWFnZS1jb252ZXJzaW9uXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBhdXRvSW1hZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygnYXV0b19pbWFnZScsIHRydWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgZmxpcCB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jZmxpcFxuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgZmxpcCgpIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdmbGlwJywgdHJ1ZSk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBmbG9wIHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyNmbG9wXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBmbG9wKCkge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ2Zsb3AnLCB0cnVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGltYWdlc2l6ZSB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jaW1hZ2Utc2l6ZVxuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgaW1hZ2VzaXplKCkge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ2ltYWdlc2l6ZScsIHRydWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgbm9NZXRhZGF0YSB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jc3RyaXAtbWV0YWRhdGFcbiAgICogQHJldHVybnMgdGhpc1xuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIG5vTWV0YWRhdGEoKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygnbm9fbWV0YWRhdGEnLCB0cnVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIFByb2dyZXNzaXZlIEpQRUcgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI3Byb2dyZXNzaXZlLWpwZWdcbiAgICogQHJldHVybnMgdGhpc1xuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHBqcGcocGFyYW1zOiBQcm9ncmVzc2l2ZUpwZ1BhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ3BqcGcnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgaW1hZ2VzaXplIHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyNzbWFydC1jcm9wXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBzbWFydENyb3AocGFyYW1zOiBTbWFydENyb3BQYXJhbXMpIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdzbWFydF9jcm9wJywgcGFyYW1zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIHdhdGVybWFydCB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jd2F0ZXJtYXJrXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICB3YXRlcm1hcmsocGFyYW1zOiBXYXRlcm1hcmtQYXJhbXMpIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCd3YXRlcm1hcmsnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgZW5oYW5jZSB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jZW5oYW5jZVxuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgZW5oYW5jZShwYXJhbXM/OiBFbmhhbmNlUGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygnZW5oYW5jZScsIHBhcmFtcyB8fCB0cnVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgc2VjdXJpdHkgdG8gbGlua1xuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jcmVkZXllXG4gICAqIEByZXR1cm5zXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgcmVkZXllKCkge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ3JlZGV5ZScsIHRydWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBtb25vY2hyb21lIHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyNtb25vY2hyb21lXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBtb25vY2hyb21lKCkge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ21vbm9jaHJvbWUnLCB0cnVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgY29tcHJlc3MgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI2NvbXByZXNzXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBjb21wcmVzcyhwYXJhbXM/OiBDb21wcmVzc1BhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ2NvbXByZXNzJywgcGFyYW1zIHx8IHRydWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgbmVnYXRpdmUgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI25lZ2F0aXZlXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBuZWdhdGl2ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCduZWdhdGl2ZScsIHRydWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgdGFncyB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jdGFnc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgdGFncygpIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCd0YWdzJywgdHJ1ZSk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBzZncgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI3Nmd1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgc2Z3KCkge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ3NmdycsIHRydWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBhbmltYXRlIHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyNhbmltYXRlLWltYWdlcy10by1naWZcbiAgICogQHBhcmFtIHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgYW5pbWF0ZShwYXJhbXM6IEFuaW1hdGlvblBhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ2FuaW1hdGUnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgc3RvcmUgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI3N0b3JlXG4gICAqIEBwYXJhbSB7KFN0b3JlUGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgc3RvcmUocGFyYW1zPzogU3RvcmVQYXJhbXMgfCBib29sZWFuKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygnc3RvcmUnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgY2FjaGUgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI2NhY2hlXG4gICAqIEBwYXJhbSB7KENhY2hlUGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgY2FjaGUocGFyYW1zOiBDYWNoZVBhcmFtcyB8IGJvb2xlYW4pIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdjYWNoZScsIHBhcmFtcyk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyByZXNpemUgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI3Jlc2l6ZVxuICAgKiBAcGFyYW0ge1Jlc2l6ZVBhcmFtc30gcGFyYW1zXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICByZXNpemUocGFyYW1zOiBSZXNpemVQYXJhbXMpIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdyZXNpemUnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgY3JvcCB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jY3JvcFxuICAgKiBAcGFyYW0ge0Nyb3BQYXJhbXN9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgY3JvcChwYXJhbXM6IENyb3BQYXJhbXMpIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdjcm9wJywgcGFyYW1zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIHJvdGF0ZSB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jcm90YXRlXG4gICAqIEBwYXJhbSB7Um90YXRlUGFyYW1zfSBwYXJhbXNcbiAgICogQHJldHVybnMgdGhpc1xuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHJvdGF0ZShwYXJhbXM6IFJvdGF0ZVBhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ3JvdGF0ZScsIHBhcmFtcyk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBkZXRlY3RfZmFjZXMgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI2ZhY2lhbC1kZXRlY3Rpb25cbiAgICogQHBhcmFtIHsoRGV0ZWN0RmFjZXNQYXJhbXMgfCBib29sZWFuKX0gcGFyYW1zXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBkZXRlY3RGYWNlcyhwYXJhbXM/OiBEZXRlY3RGYWNlc1BhcmFtcyB8IGJvb2xlYW4pIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdkZXRlY3RfZmFjZXMnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgY3JvcCBmYWNlcyB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jY3JvcC1mYWNlc1xuICAgKiBAcGFyYW0ge0Nyb3BGYWNlc1BhcmFtc30gcGFyYW1zXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBjcm9wRmFjZXMocGFyYW1zOiBDcm9wRmFjZXNQYXJhbXMpIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdjcm9wX2ZhY2VzJywgcGFyYW1zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIHBpeGVsYXRlIGZhY2VzIHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyNwaXhlbGF0ZS1mYWNlc1xuICAgKiBAcGFyYW0ge1BpeGVsYXRlRmFjZXNQYXJhbXN9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgcGl4ZWxhdGVGYWNlcyhwYXJhbXM6IFBpeGVsYXRlRmFjZXNQYXJhbXMpIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdwaXhlbGF0ZV9mYWNlcycsIHBhcmFtcyk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBibHVyIGZhY2VzIHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyNibHVyLWZhY2VzXG4gICAqIEBwYXJhbSB7Qmx1ckZhY2VzUGFyYW1zfSBwYXJhbXNcbiAgICogQHJldHVybnMgdGhpc1xuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIGJsdXJGYWNlcyhwYXJhbXM6IEJsdXJGYWNlc1BhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ2JsdXJfZmFjZXMnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgcm91bmRlZCBjb3JuZXJzIHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyNyb3VuZGVkLWNvcm5lcnNcbiAgICogQHBhcmFtIHsoUm91bmRlZENvcm5lcnNQYXJhbXMgfCBib29sZWFuKX0gcGFyYW1zXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICByb3VuZGVkQ29ybmVycyhwYXJhbXM/OiBSb3VuZGVkQ29ybmVyc1BhcmFtcyB8IGJvb2xlYW4pIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdyb3VuZGVkX2Nvcm5lcnMnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgcG9sYXJvaWQgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI3BvbGFyb2lkXG4gICAqIEBwYXJhbSB7KFBvbGFyb2lkUGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgcG9sYXJvaWQocGFyYW1zPzogUG9sYXJvaWRQYXJhbXMgfCBib29sZWFuKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygncG9sYXJvaWQnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgdmlnbmV0dGUgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI3ZpZ25ldHRlXG4gICAqIEBwYXJhbSB7KFZpZ25ldHRlUGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgdmlnbmV0dGUocGFyYW1zPzogVmlnbmV0dGVQYXJhbXMgfCBib29sZWFuKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygndmlnbmV0dGUnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgdG9ybiBlZGdlcyB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jdG9ybi1lZGdlc1xuICAgKiBAcGFyYW0geyhUb3JuRWRnZXNQYXJhbXMgfCBib29sZWFuKX0gcGFyYW1zXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICB0b3JuRWRnZXMocGFyYW1zPzogVG9ybkVkZ2VzUGFyYW1zIHwgYm9vbGVhbikge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ3Rvcm5fZWRnZXMnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgc2hhZG93IHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyNzaGFkb3dcbiAgICogQHBhcmFtIHsoU2hhZG93UGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgc2hhZG93KHBhcmFtcz86IFNoYWRvd1BhcmFtcyB8IGJvb2xlYW4pIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdzaGFkb3cnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgY2lyY2xlIHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyNjaXJjbGVcbiAgICogQHBhcmFtIHsoQ2lyY2xlUGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgY2lyY2xlKHBhcmFtcz86IENpcmNsZVBhcmFtcyB8IGJvb2xlYW4pIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdjaXJjbGUnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYm9yZGVyIHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyNib3JkZXJcbiAgICogQHBhcmFtIHsoQm9yZGVyUGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgYm9yZGVyKHBhcmFtcz86IEJvcmRlclBhcmFtcyB8IGJvb2xlYW4pIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdib3JkZXInLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgc2hhcnBlbiB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jc2hhcnBlblxuICAgKiBAcGFyYW0geyhTaGFycGVuUGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgc2hhcnBlbihwYXJhbXM/OiBTaGFycGVuUGFyYW1zIHwgYm9vbGVhbikge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ3NoYXJwZW4nLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYmx1ciB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jYmx1clxuICAgKiBAcGFyYW0geyhCbHVyUGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgYmx1cihwYXJhbXM/OiBCbHVyUGFyYW1zIHwgYm9vbGVhbikge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ2JsdXInLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgYmxhY2t3aGl0ZSB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jYmxhY2t3aGl0ZVxuICAgKiBAcGFyYW0geyhCbGFja3doaXRlUGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgYmxhY2t3aGl0ZShwYXJhbXM/OiBCbGFja3doaXRlUGFyYW1zIHwgYm9vbGVhbikge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ2JsYWNrd2hpdGUnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgc2VwaWEgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI3NlcGlhXG4gICAqIEBwYXJhbSB7KFNlcGlhUGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgc2VwaWEocGFyYW1zPzogU2VwaWFQYXJhbXMgfCBib29sZWFuKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygnc2VwaWEnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgcGl4ZWxhdGUgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI3BpeGVsYXRlXG4gICAqIEBwYXJhbSB7KFBpeGVsYXRlUGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgcGl4ZWxhdGUocGFyYW1zPzogUGl4ZWxhdGVQYXJhbXMgfCBib29sZWFuKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygncGl4ZWxhdGUnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgb2lscGFpbnQgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI29pbC1wYWludFxuICAgKiBAcGFyYW0geyhPaWxQYWludFBhcmFtcyB8IGJvb2xlYW4pfSBwYXJhbXNcbiAgICogQHJldHVybnMgdGhpc1xuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIG9pbFBhaW50KHBhcmFtcz86IE9pbFBhaW50UGFyYW1zIHwgYm9vbGVhbikge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ29pbF9wYWludCcsIHBhcmFtcyk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBtb2R1bGF0ZSB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jbW9kdWxhdGVcbiAgICogQHBhcmFtIHsoTW9kdWxhdGVQYXJhbXMgfCBib29sZWFuKX0gcGFyYW1zXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBtb2R1bGF0ZShwYXJhbXM/OiBNb2R1bGF0ZVBhcmFtcyB8IGJvb2xlYW4pIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdtb2R1bGF0ZScsIHBhcmFtcyk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBwYXJ0aWFsIHBpeGVsYXRlIHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyNwYXJ0aWFsLXBpeGVsYXRlXG4gICAqIEBwYXJhbSB7UGFydGlhbFBpeGVsYXRlUGFyYW1zfSBwYXJhbXNcbiAgICogQHJldHVybnMgdGhpc1xuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHBhcnRpYWxQaXhlbGF0ZShwYXJhbXM6IFBhcnRpYWxQaXhlbGF0ZVBhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ3BhcnRpYWxfcGl4ZWxhdGUnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgcGFydGlhbCBibHVyIHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyNwYXJ0aWFsLWJsdXJcbiAgICogQHBhcmFtIHtQYXJ0aWFsQmx1clBhcmFtc30gcGFyYW1zXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBwYXJ0aWFsQmx1cihwYXJhbXM6IFBhcnRpYWxCbHVyUGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygncGFydGlhbF9ibHVyJywgcGFyYW1zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGNvbGxhZ2UgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI2NvbGxhZ2VcbiAgICogQHBhcmFtIHtDb2xsYWdlUGFyYW1zfSBwYXJhbXNcbiAgICogQHJldHVybnMgdGhpc1xuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIGNvbGxhZ2UocGFyYW1zOiBDb2xsYWdlUGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygnY29sbGFnZScsIHBhcmFtcyk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyB1cHNjYWxlIHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyN1cHNjYWxlXG4gICAqIEBwYXJhbSB7KFVwc2NhbGVQYXJhbXMgfCBib29sZWFuKX0gcGFyYW1zXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICB1cHNjYWxlKHBhcmFtcz86IFVwc2NhbGVQYXJhbXMgfCBib29sZWFuKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygndXBzY2FsZScsIHBhcmFtcyk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBhc2NpaSB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jYXNjaWlcbiAgICogQHBhcmFtIHsoQXNjaWlQYXJhbXMgfCBib29sZWFuKX0gcGFyYW1zXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBhc2NpaShwYXJhbXM/OiBBc2NpaVBhcmFtcyB8IGJvb2xlYW4pIHtcbiAgICByZXR1cm4gdGhpcy5hZGRUYXNrKCdhc2NpaScsIHBhcmFtcyk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBxdWFsaXR5IHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyNxdWFsaXR5XG4gICAqIEBwYXJhbSB7UXVhbGl0eVBhcmFtc30gcGFyYW1zXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBxdWFsaXR5KHBhcmFtczogUXVhbGl0eVBhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ3F1YWxpdHknLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgc2VjdXJpdHkgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI3NlY3VyaXR5XG4gICAqIEBwYXJhbSB7U2VjdXJpdHlQYXJhbXN9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgc2VjdXJpdHkocGFyYW1zOiBTZWN1cml0eVBhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ3NlY3VyaXR5JywgcGFyYW1zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIG91dHB1dCB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jb3V0cHV0XG4gICAqIEBwYXJhbSB7T3V0cHV0UGFyYW1zfSBwYXJhbXNcbiAgICogQHJldHVybnMgdGhpc1xuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIG91dHB1dChwYXJhbXM6IE91dHB1dFBhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ291dHB1dCcsIHBhcmFtcyk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyB2aWRlbyBjb252ZXJ0IHRyYW5zZm9ybWF0aW9uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZmlsZXN0YWNrLmNvbS9kb2NzL2FwaS9wcm9jZXNzaW5nLyN2aWRlby1jb252ZXJ0XG4gICAqIEBwYXJhbSB7VmlkZW9Db252ZXJ0UGFyYW1zfSBwYXJhbXNcbiAgICogQHJldHVybnMgdGhpc1xuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHZpZGVvQ29udmVydChwYXJhbXM6IFZpZGVvQ29udmVydFBhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ3ZpZGVvX2NvbnZlcnQnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgVVJMU2NyZWVuc2hvdCB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jdXJsc2NyZWVuc2hvdFxuICAgKiBAcGFyYW0geyhVUkxTY3JlZW5zaG90UGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgVVJMU2NyZWVuc2hvdChwYXJhbXM/OiBVUkxTY3JlZW5zaG90UGFyYW1zIHwgYm9vbGVhbikge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ3VybHNjcmVlbnNob3QnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgcGRmaW5mbyB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jcGRmaW5mb1xuICAgKiBAcGFyYW0geyhQZGZJbmZvUGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgUERGSW5mbyhwYXJhbXM/OiBQZGZJbmZvUGFyYW1zIHwgYm9vbGVhbikge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ3BkZmluZm8nLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgcGRmY29udmVydCB0cmFuc2Zvcm1hdGlvblxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jcGRmY29udmVydFxuICAgKiBAcGFyYW0geyhQZGZDb252ZXJ0UGFyYW1zIHwgYm9vbGVhbil9IHBhcmFtc1xuICAgKiBAcmV0dXJucyB0aGlzXG4gICAqIEBtZW1iZXJvZiBGaWxlbGlua1xuICAgKi9cbiAgUERGQ29udmVydChwYXJhbXM/OiBQZGZDb252ZXJ0UGFyYW1zIHwgYm9vbGVhbikge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ3BkZmNvbnZlcnQnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgZmFsbGJhY2sgdHJhbnNmb3JtYXRpb25cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5maWxlc3RhY2suY29tL2RvY3MvYXBpL3Byb2Nlc3NpbmcvI2ZhbGxiYWNrXG4gICAqIEBwYXJhbSB7KEZhbGxiYWNrUGFyYW1zKX0gcGFyYW1zXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBmYWxsYmFjayhwYXJhbXM6IEZhbGxiYWNrUGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygnZmFsbGJhY2snLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCB6aXAgdHJhbnNmb3JtYXRpb24gd2hpY2ggY3JlYXRlIGEgemlwIHBhY2thZ2Ugb24gZmlsZXNcbiAgICogdXNlZCBvbiBhY3R1YWwgY29udGV4dFxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmZpbGVzdGFjay5jb20vZG9jcy9hcGkvcHJvY2Vzc2luZy8jemlwXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICB6aXAoKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygnemlwJywgdHJ1ZSk7XG4gIH1cblxuICAvKipcbiAgICogQWRkIHRhc2sgd2hpY2ggbWluaWZ5IGEgY3NzIGZpbGVcbiAgICpcbiAgICogQHJldHVybnMgdGhpc1xuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIG1pbmlmeUNzcyhwYXJhbXM6IE1pbmlmeUNzc1BhcmFtcykge1xuICAgIHJldHVybiB0aGlzLmFkZFRhc2soJ21pbmlmeV9jc3MnLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCB0YXNrIHdoaWNoIG1pbmlmeSBhIGphdmFzY3JpcHQgZmlsZS5cbiAgICogRm9yIGJldHRlciBoYW5kbGluZyBvZiAndGFyZ2V0cycgcGFyYW0sIHVzZSB3aXRoIGI2NCBmbGFnIGVuYWJsZWQuXG4gICAqXG4gICAqIEByZXR1cm5zIHRoaXNcbiAgICogQG1lbWJlcm9mIEZpbGVsaW5rXG4gICAqL1xuICBtaW5pZnlKcyhwYXJhbXM6IE1pbmlmeUpzUGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkVGFzaygnbWluaWZ5X2pzJywgcGFyYW1zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgc291cmNlIGlzIGV4dGVybmFsXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHByaXZhdGUgaXNTb3VyY2VFeHRlcm5hbCgpOiBib29sZWFuIHtcbiAgICBpZiAoIXRoaXMuc291cmNlKSB7XG4gICAgICB0aHJvdyBuZXcgRmlsZXN0YWNrRXJyb3IoJ1NvdXJjZSBub3QgU2V0Jyk7XG4gICAgfVxuXG4gICAgbGV0IHRvVGVzdCA9IEFycmF5LmlzQXJyYXkodGhpcy5zb3VyY2UpID8gdGhpcy5zb3VyY2UgOiBbdGhpcy5zb3VyY2VdO1xuICAgIGZvciAobGV0IGkgaW4gdG9UZXN0KSB7XG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgICAgaWYgKCF0b1Rlc3QuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlmICh0b1Rlc3RbaV0uaW5kZXhPZignc3JjOicpID09PSAwIHx8ICh0b1Rlc3RbaV0uaW5kZXhPZignaHR0cCcpID09PSAwICYmIHRvVGVzdFtpXS5pbmRleE9mKCdmaWxlc3RhY2tjb250ZW50JykgPT09IC0xKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgZXZlcnkgdGFzayBhZ2FpbnN0IHNjaGVtYVxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge29iamVjdFtdfSB0cmFuc2Zvcm1hdGlvbnMgLSBvYmplY3Qgd2hpY2ggY29udGFpbiBhbGwgdHJhbnNmb3JtYXRpb25zXG4gICAqIEByZXR1cm5zIHt2b2lkfVxuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHByaXZhdGUgdmFsaWRhdGVUYXNrcyh0cmFuc2Zvcm1hdGlvbnM6IG9iamVjdFtdKTogdm9pZCB7XG4gICAgY29uc3QgcmVzID0gRmlsZWxpbmsudmFsaWRhdG9yKHRoaXMuYXJyYXlUb09iamVjdCh0cmFuc2Zvcm1hdGlvbnMsICduYW1lJywgJ3BhcmFtcycpKTtcbiAgICBpZiAocmVzLmVycm9ycy5sZW5ndGgpIHtcbiAgICAgIHRocm93IG5ldyBGaWxlc3RhY2tFcnJvcihgUGFyYW1zIHZhbGlkYXRpb24gZXJyb3JgLCByZXMuZXJyb3JzLCBGaWxlc3RhY2tFcnJvclR5cGUuVkFMSURBVElPTik7XG4gICAgfVxuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgY29ycmVjdCBjZG4gdXJsIHdpdGggY25hbWUgc3VwcG9ydFxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHByaXZhdGUgZ2V0Q2RuSG9zdCgpOiBzdHJpbmcge1xuICAgIGxldCB1cmxzID0gT2JqZWN0LmFzc2lnbih7fSwgY29uZmlnLnVybHMpO1xuXG4gICAgaWYgKHRoaXMuY3VzdG9tRG9tYWluKSB7XG4gICAgICB1cmxzLmNkblVybCA9IHRoaXMuY3VzdG9tRG9tYWluO1xuICAgIH1cblxuICAgIHVybHMgPSByZXNvbHZlSG9zdCh1cmxzLCB0aGlzLmNuYW1lKTtcblxuICAgIHJldHVybiB1cmxzLmNkblVybDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFwcGxpZWQgdHJhbnNmb3JtYXRpb25zIGFzIHN0cmluZ1xuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVUcmFuc2Zvcm1TdHJpbmcoKTogc3RyaW5nIHtcbiAgICBsZXQgdHJhbnNmb3JtcyA9IFtdO1xuXG4gICAgdGhpcy50cmFuc2Zvcm1zLmZvckVhY2goZWwgPT4ge1xuICAgICAgdHJhbnNmb3Jtcy5wdXNoKHRoaXMub3B0aW9uVG9TdHJpbmcoZWwubmFtZSwgZWwucGFyYW1zKSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdHJhbnNmb3Jtcy5qb2luKCcvJyk7XG4gIH1cblxuICAvKipcbiAgICogRmxhdHRlbiB0cmFuc2Zvcm1hdGlvbiBvcHRpb24gdG8gc3RyaW5nXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBleGFtcGxlIHtyZXNpemU6e3dpZHRoOiAxMDAsaGVpZ2h0OiAyMDB9fSA9PiByZXNpemU9d2lkdGg6MTAwLGhlaWdodDoyMDBcbiAgICogQHBhcmFtIGtleSAtIG9wdGlvbiBrZXlcbiAgICogQHBhcmFtIHZhbHVlcyAtIG9wdGlvbiBwYXJhbXNcbiAgICovXG4gIHByaXZhdGUgb3B0aW9uVG9TdHJpbmcoa2V5OiBzdHJpbmcsIHZhbHVlczogYW55KTogc3RyaW5nIHtcbiAgICBsZXQgb3B0aW9uc1N0cmluZzogc3RyaW5nW10gPSBbXTtcbiAgICBpZiAodHlwZW9mIHZhbHVlcyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHJldHVybiBrZXk7XG4gICAgfVxuXG4gICAgLy8gaWYgd2UganVzdCB3YW50IHRvIGVuYWJsZSBmZWF0dXJlXG4gICAgaWYgKHR5cGVvZiB2YWx1ZXMgPT09ICdib29sZWFuJykge1xuICAgICAgaWYgKCF2YWx1ZXMgJiYga2V5ID09PSAnY2FjaGUnKSB7XG4gICAgICAgIHJldHVybiAnY2FjaGU9ZmFsc2UnO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ga2V5O1xuICAgIH1cblxuICAgIE9iamVjdC5rZXlzKHZhbHVlcykuZm9yRWFjaChpID0+IHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlc1tpXSkpIHtcbiAgICAgICAgb3B0aW9uc1N0cmluZy5wdXNoKGAke2l9OiR7dGhpcy5hcnJheVRvU3RyaW5nKHZhbHVlc1tpXSl9YCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgb3B0aW9uc1N0cmluZy5wdXNoKGAke2l9OiR7dGhpcy5lc2NhcGVWYWx1ZSh2YWx1ZXNbaV0pfWApO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGAke2tleX09JHtvcHRpb25zU3RyaW5nLmpvaW4oJywnKX1gO1xuICB9XG5cbiAgLyoqXG4gICAqIEVzY2FwZSBwYXJhbXMgdmFsdWVzXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgKiBAbWVtYmVyb2YgRmlsZWxpbmtcbiAgICovXG4gIHByaXZhdGUgZXNjYXBlVmFsdWUodmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICBpZiAodmFsdWUuaW5kZXhPZignLycpID4gLTEgfHwgdmFsdWUuaW5kZXhPZignLCcpID4gLTEpIHtcbiAgICAgIHJldHVybiBgXCIke3ZhbHVlfVwiYDtcbiAgICB9XG5cbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydHMgbmVzdGVkIGFycmF5cyB0byBzdHJpbmdcbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQGV4YW1wbGUgWzEsMiwgWzIsM11dID0+IFwiWzEsMiwgWzIsM11dXCJcbiAgICogQHBhcmFtIGFyciAtIGFueSBhcnJheVxuICAgKi9cbiAgcHJpdmF0ZSBhcnJheVRvU3RyaW5nKGFycjogYW55W10pOiBzdHJpbmcge1xuICAgIGNvbnN0IHRvUmV0dXJuID0gYXJyLm1hcChlbCA9PiB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShlbCkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXJyYXlUb1N0cmluZyhlbCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmVzY2FwZVZhbHVlKGVsKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBgWyR7dG9SZXR1cm59XWA7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydHMgYXJyYXkgb2Ygb2JqZWN0cyB0byBvYmplY3RcbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQGV4YW1wbGUgW3tuYW1lOiAncmVzaXplJywgcGFyYW1zOiB7aGVpZ2h0OiAxMjV9fV0gPT4ge3Jlc2l6ZToge2hlaWdodDogMTI1fX1cbiAgICogQHBhcmFtIGFyciAtIGFueSBhcnJheVxuICAgKi9cbiAgcHJpdmF0ZSBhcnJheVRvT2JqZWN0ID0gKGFycmF5OiBvYmplY3RbXSA9IFtdLCBuYW1lS2V5OiBzdHJpbmcsIGRhdGFLZXk6IHN0cmluZykgPT4ge1xuICAgIHJldHVybiBhcnJheS5yZWR1Y2UoKG9iaiwgaXRlbSkgPT4ge1xuICAgICAgb2JqW2l0ZW1bbmFtZUtleV1dID0gaXRlbVtkYXRhS2V5XTtcbiAgICAgIHJldHVybiBvYmo7XG4gICAgfSwge30pO1xuICB9XG59XG4iXX0=
