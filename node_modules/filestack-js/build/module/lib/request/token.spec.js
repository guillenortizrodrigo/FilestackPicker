/*
 * Copyright (c) 2019 by Filestack.
 * Some rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { FsCancelToken } from './token';
describe('Request/Token', function () {
    describe('cancel', function () {
        var token = new FsCancelToken();
        it('cancel token should return undefined without value', function () { return expect(token.cancel()).toEqual(undefined); });
    });
    describe('cancel', function () {
        var token = new FsCancelToken();
        // @ts-ignore
        it("cancel token should return undefined with value new String('Aborted')", function () { return expect(token.cancel(new String('Aborted'))).toEqual(undefined); });
    });
    describe('source token', function () {
        it('Cancel event should be called', function (done) {
            var token = new FsCancelToken();
            var cancelSpy = jest.fn().mockName('cancelSpy');
            token.once('cancel', cancelSpy);
            token.cancel();
            setTimeout(function () {
                expect(cancelSpy).toHaveBeenCalled();
                done();
            }, 10);
        });
    });
    it('Cancel event should be called with reason', function (done) {
        var token = new FsCancelToken();
        var cancelSpy = jest.fn().mockName('cancelSpy');
        var cancelReason = 'test';
        token.once('cancel', cancelSpy);
        token.cancel(cancelReason);
        setTimeout(function () {
            expect(cancelSpy).toHaveBeenCalledWith(cancelReason);
            done();
        }, 10);
    });
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9saWIvcmVxdWVzdC90b2tlbi5zcGVjLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7R0FlRztBQUVILE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFFeEMsUUFBUSxDQUFDLGVBQWUsRUFBRTtJQUN4QixRQUFRLENBQUMsUUFBUSxFQUFFO1FBQ2pCLElBQU0sS0FBSyxHQUFHLElBQUksYUFBYSxFQUFFLENBQUM7UUFDbEMsRUFBRSxDQUFDLG9EQUFvRCxFQUFFLGNBQU0sT0FBQSxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxFQUF6QyxDQUF5QyxDQUFDLENBQUM7SUFDNUcsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsUUFBUSxFQUFFO1FBQ2pCLElBQU0sS0FBSyxHQUFHLElBQUksYUFBYSxFQUFFLENBQUM7UUFDbEMsYUFBYTtRQUNiLEVBQUUsQ0FBQyx1RUFBdUUsRUFBRSxjQUFNLE9BQUEsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsRUFBOUQsQ0FBOEQsQ0FBQyxDQUFDO0lBQ3BKLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGNBQWMsRUFBRTtRQUN2QixFQUFFLENBQUMsK0JBQStCLEVBQUUsVUFBQSxJQUFJO1lBQ3RDLElBQU0sS0FBSyxHQUFHLElBQUksYUFBYSxFQUFFLENBQUM7WUFDbEMsSUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUVsRCxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxTQUFTLENBQUMsQ0FBQztZQUNoQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUM7WUFFZixVQUFVLENBQUM7Z0JBQ1QsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7Z0JBQ3JDLElBQUksRUFBRSxDQUFDO1lBQ1QsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQ1QsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQywyQ0FBMkMsRUFBRSxVQUFBLElBQUk7UUFDbEQsSUFBTSxLQUFLLEdBQUcsSUFBSSxhQUFhLEVBQUUsQ0FBQztRQUNsQyxJQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ2xELElBQU0sWUFBWSxHQUFHLE1BQU0sQ0FBQztRQUU1QixLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxTQUFTLENBQUMsQ0FBQztRQUNoQyxLQUFLLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBRTNCLFVBQVUsQ0FBQztZQUNULE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUNyRCxJQUFJLEVBQUUsQ0FBQztRQUNULENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUNULENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoibGliL3JlcXVlc3QvdG9rZW4uc3BlYy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTkgYnkgRmlsZXN0YWNrLlxuICogU29tZSByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEZzQ2FuY2VsVG9rZW4gfSBmcm9tICcuL3Rva2VuJztcblxuZGVzY3JpYmUoJ1JlcXVlc3QvVG9rZW4nLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdjYW5jZWwnLCAoKSA9PiB7XG4gICAgY29uc3QgdG9rZW4gPSBuZXcgRnNDYW5jZWxUb2tlbigpO1xuICAgIGl0KCdjYW5jZWwgdG9rZW4gc2hvdWxkIHJldHVybiB1bmRlZmluZWQgd2l0aG91dCB2YWx1ZScsICgpID0+IGV4cGVjdCh0b2tlbi5jYW5jZWwoKSkudG9FcXVhbCh1bmRlZmluZWQpKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NhbmNlbCcsICgpID0+IHtcbiAgICBjb25zdCB0b2tlbiA9IG5ldyBGc0NhbmNlbFRva2VuKCk7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGl0KFwiY2FuY2VsIHRva2VuIHNob3VsZCByZXR1cm4gdW5kZWZpbmVkIHdpdGggdmFsdWUgbmV3IFN0cmluZygnQWJvcnRlZCcpXCIsICgpID0+IGV4cGVjdCh0b2tlbi5jYW5jZWwobmV3IFN0cmluZygnQWJvcnRlZCcpKSkudG9FcXVhbCh1bmRlZmluZWQpKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NvdXJjZSB0b2tlbicsICgpID0+IHtcbiAgICBpdCgnQ2FuY2VsIGV2ZW50IHNob3VsZCBiZSBjYWxsZWQnLCBkb25lID0+IHtcbiAgICAgIGNvbnN0IHRva2VuID0gbmV3IEZzQ2FuY2VsVG9rZW4oKTtcbiAgICAgIGNvbnN0IGNhbmNlbFNweSA9IGplc3QuZm4oKS5tb2NrTmFtZSgnY2FuY2VsU3B5Jyk7XG5cbiAgICAgIHRva2VuLm9uY2UoJ2NhbmNlbCcsIGNhbmNlbFNweSk7XG4gICAgICB0b2tlbi5jYW5jZWwoKTtcblxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGV4cGVjdChjYW5jZWxTcHkpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgICAgZG9uZSgpO1xuICAgICAgfSwgMTApO1xuICAgIH0pO1xuICB9KTtcblxuICBpdCgnQ2FuY2VsIGV2ZW50IHNob3VsZCBiZSBjYWxsZWQgd2l0aCByZWFzb24nLCBkb25lID0+IHtcbiAgICBjb25zdCB0b2tlbiA9IG5ldyBGc0NhbmNlbFRva2VuKCk7XG4gICAgY29uc3QgY2FuY2VsU3B5ID0gamVzdC5mbigpLm1vY2tOYW1lKCdjYW5jZWxTcHknKTtcbiAgICBjb25zdCBjYW5jZWxSZWFzb24gPSAndGVzdCc7XG5cbiAgICB0b2tlbi5vbmNlKCdjYW5jZWwnLCBjYW5jZWxTcHkpO1xuICAgIHRva2VuLmNhbmNlbChjYW5jZWxSZWFzb24pO1xuXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBleHBlY3QoY2FuY2VsU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjYW5jZWxSZWFzb24pO1xuICAgICAgZG9uZSgpO1xuICAgIH0sIDEwKTtcbiAgfSk7XG59KTtcbiJdfQ==
